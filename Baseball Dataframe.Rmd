---
title: "Baseball Dataframe"
author: "Adam Chapnik"
date: "12/1/2018"
output: html_document
---

This code collects all of the Baseball Savant data from 2008-2017. Data from 2018 will be loaded separately. 

From: https://billpetti.github.io/2018-02-19-build-statcast-database-rstats/


```{r}
require(readr)
require(dplyr)
require(xml2)
require(magrittr)

dates_reduced <- read_csv("https://raw.githubusercontent.com/BillPetti/baseball_research_notebook/master/dates_statcast_build.csv")

x2008season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2008)

x2009season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2009)

x2010season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2010)

x2011season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2011)

x2012season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2012)

x2013season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2013)

x2014season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2014)

x2015season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2015)

x2016season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2016)

x2017season <- dates_reduced %>%
  filter(substr(GameDate, 1, 4) == 2017)

scrape_statcast_savant_pitcher_date <- function(start_date, end_date) {
  
  # extract year
  year <- substr(start_date, 1,4)
  
  # Base URL.
  url <- paste0("https://baseballsavant.mlb.com/statcast_search/csv?all=true&hfPT=&hfAB=&hfBBT=&hfPR=&hfZ=&stadium=&hfBBL=&hfNewZones=&hfGT=R%7C&hfC=&hfSea=",year,"%7C&hfSit=&player_type=pitcher&hfOuts=&opponent=&pitcher_throws=&batter_stands=&hfSA=&game_date_gt=",start_date,"&game_date_lt=",end_date,"&team=&position=&hfRO=&home_road=&hfFlag=&metric_1=&hfInn=&min_pitches=0&min_results=0&group_by=name&sort_col=pitches&player_event_sort=h_launch_speed&sort_order=desc&min_abs=0&type=details&")
  
  payload <- utils::read.csv(url)
  
  if (length(payload$pitch_type) > 0) {
  
  # Clean up formatting.
  payload$game_date <- as.Date(payload$game_date, "%Y-%m-%d")
  payload$des <- as.character(payload$des)
  payload$game_pk <- as.character(payload$game_pk) %>% as.numeric()
  payload$on_1b <- as.character(payload$on_1b) %>% as.numeric()
  payload$on_2b <- as.character(payload$on_2b) %>% as.numeric()
  payload$on_3b <- as.character(payload$on_3b) %>% as.numeric()
  payload$release_pos_x <- as.character(payload$release_pos_x) %>% as.numeric()
  payload$release_pos_z <- as.character(payload$release_pos_z) %>% as.numeric()
  payload$release_pos_y <- as.character(payload$release_pos_y) %>% as.numeric()
  payload$pfx_x <- as.character(payload$pfx_x) %>% as.numeric()
  payload$pfx_z <- as.character(payload$pfx_z) %>% as.numeric()
  payload$hc_x <- as.character(payload$hc_x) %>% as.numeric()
  payload$hc_y <- as.character(payload$hc_y) %>% as.numeric()
  payload$woba_denom <- as.character(payload$woba_denom) %>% as.numeric()
  payload$woba_value <- as.character(payload$woba_value) %>% as.numeric()
  payload$babip_value <- as.character(payload$babip_value) %>% as.numeric()
  payload$iso_value <- as.character(payload$iso_value) %>% as.numeric()
  payload$plate_z <- as.character(payload$plate_z) %>% as.numeric()
  payload$plate_x <- as.character(payload$plate_x) %>% as.numeric()
  payload$vx0 <- as.character(payload$vx0) %>% as.numeric()
  payload$vy0 <- as.character(payload$vy0) %>% as.numeric()
  payload$vz0 <- as.character(payload$vz0) %>% as.numeric()
  payload$ax <- as.character(payload$ax) %>% as.numeric()
  payload$ay <- as.character(payload$ay) %>% as.numeric()
  payload$az <- as.character(payload$az) %>% as.numeric()
  payload$sz_top <- as.character(payload$sz_top) %>% as.numeric()
  payload$sz_bot <- as.character(payload$sz_bot) %>% as.numeric()
  payload$hit_distance_sc <- as.character(payload$hit_distance_sc) %>% as.numeric()
  payload$launch_speed <- as.character(payload$launch_speed) %>% as.numeric()
  payload$launch_speed_angle <- as.character(payload$launch_speed_angle) %>% as.numeric()
  payload$launch_angle <- as.character(payload$launch_angle) %>% as.numeric()
  payload$estimated_ba_using_speedangle <- as.character(payload$estimated_ba_using_speedangle) %>% as.numeric()
  payload$estimated_woba_using_speedangle <- as.character(payload$estimated_woba_using_speedangle) %>% as.numeric()
  payload$effective_speed <- as.character(payload$effective_speed) %>% as.numeric()
  payload$release_speed <- as.character(payload$release_speed) %>% as.numeric()
  payload$zone <- as.character(payload$zone) %>% as.numeric()
  payload$release_spin_rate <- as.character(payload$release_spin_rate) %>% as.numeric()
  payload$release_extension <- as.character(payload$release_extension) %>% as.numeric()
  payload$barrel <- with(payload, ifelse(launch_angle <= 50 & launch_speed >= 98 & launch_speed * 1.5 - launch_angle >= 117 & launch_speed + launch_angle >= 124, 1, 0))
  payload$home_team <- as.character(payload$home_team)
  payload$away_team <- as.character(payload$away_team)
  
  return(payload)
  }
  
  else {
    vars <- names(payload)
    df <- lapply(vars, function(x) x <- NA)
    names(df) <- names(payload)
    payload_na <- bind_rows(df)
  
    return(payload_na)
    
    Sys.sleep(sample(x = runif(20, min = .01, max = 1), size = 1))
  }
}

x2008data <- x2008season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

(missing_2008 <- x2008data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2009data <- x2009season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2009 <- x2009data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2010data <- x2010season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2010 <- x2010data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2011data <- x2011season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2011 <- x2011data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2012data <- x2012season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2012 <- x2012data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2013data <- x2013season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2013 <- x2013data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2014data <- x2014season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2014 <- x2014data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2015data <- x2015season %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_2015 <- x2015data %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data1 <- x2016season[c(1:20),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20161 <- x2016data1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data2 <- x2016season[c(21:40),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20162 <- x2016data2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data3 <- x2016season[c(41:60),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20163 <- x2016data3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data4 <- x2016season[c(61:80),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20164 <- x2016data4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data5 <- x2016season[c(81:100),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20165 <- x2016data5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data6 <- x2016season[c(101:120),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20166 <- x2016data6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data7 <- x2016season[c(121:140),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20167 <- x2016data7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data8 <- x2016season[c(141:160),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20168 <- x2016data8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data9 <- x2016season[c(161:162),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20169 <- x2016data9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data10 <- x2016season[c(163:164),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_201610 <- x2016data10 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data11 <- x2016season[c(165:166),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_201611 <- x2016data11 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

 x2016data12 <- x2016season[c(167:168),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_201612 <- x2016data12 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data13 <- x2016season[169,] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_201613 <- x2016data13 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data14 <- x2016season[170,] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_201614 <- x2016data14 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data15 <- x2016season[c(171:172),] %>% 
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_201615 <- x2016data15 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2016data <- rbind(x2016data1, x2016data2, x2016data3, x2016data4, x2016data5, x2016data6, x2016data7, x2016data8, x2016data9, x2016data10, x2016data11, x2016data12, x2016data13, x2016data14, x2016data15)


## 2017
x2017data1 <- x2017season[c(1:2),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20171 <- x2017data1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data1.1 <- x2017season[3,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20171.1 <- x2017data1.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data1.1.1 <- x2017season[c(4:5),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20171.1.1 <- x2017data1.1.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data1.2 <- x2017season[c(6:10),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20171.2 <- x2017data1.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data1.3 <- x2017season[c(11:20),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20171.3 <- x2017data1.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data2 <- x2017season[c(21:22),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20172 <- x2017data2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data2.1 <- x2017season[23,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20172.1 <- x2017data2.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data2.1.1 <- x2017season[24,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20172.1.1 <- x2017data2.1.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data2.1.2 <- x2017season[25,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20172.1.2 <- x2017data2.1.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data2.2 <- x2017season[c(26:30),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20172.2 <- x2017data2.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data2.3 <- x2017season[c(31:40),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20172.3 <- x2017data2.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data3 <- x2017season[c(41:50),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20173 <- x2017data3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data3.1 <- x2017season[c(51:55),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20173.1 <- x2017data3.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data3.2 <- x2017season[c(56:57),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20173.2 <- x2017data3.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data3.3 <- x2017season[58,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20173.3 <- x2017data3.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data3.4 <- x2017season[59,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20173.4 <- x2017data3.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data3.5 <- x2017season[60,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20173.5 <- x2017data3.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4 <- x2017season[61,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174 <- x2017data4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.1.1 <- x2017season[62,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.1.1 <- x2017data4.1.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.1.2 <- x2017season[63,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.1.2 <- x2017data4.1.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.1.3 <- x2017season[64,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.1.3 <- x2017data4.1.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.1.4 <- x2017season[65,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.1.4 <- x2017data4.1.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.2 <- x2017season[66,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.2 <- x2017data4.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.2.1 <- x2017season[67,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.2.1 <- x2017data4.2.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.2.2 <- x2017season[68,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.2.2 <- x2017data4.2.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.2.3 <- x2017season[c(69:70),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.2.3 <- x2017data4.2.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.3 <- x2017season[c(71:72),] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.3 <- x2017data4.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.3.1 <- x2017season[73,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.3.1 <- x2017data4.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.3.2 <- x2017season[74,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.3.2 <- x2017data4.3.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.3.3 <- x2017season[75,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.3.3 <- x2017data4.3.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.4 <- x2017season[76,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.4 <- x2017data4.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.5 <- x2017season[77,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.5 <- x2017data4.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.6 <- x2017season[78,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.6 <- x2017data4.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.7 <- x2017season[79,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.7 <- x2017data4.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data4.8 <- x2017season[80,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20174.8 <- x2017data4.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5 <- x2017season[81,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175 <- x2017data5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.1 <- x2017season[82,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.1 <- x2017data5.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.1.1 <- x2017season[83,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.1.1 <- x2017data5.1.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.1.2 <- x2017season[84,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.1.2 <- x2017data5.1.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.1.3 <- x2017season[85,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.1.3 <- x2017data5.1.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.1.4 <- x2017season[86,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.1.4 <- x2017data5.1.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.1.5 <- x2017season[87,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.1.5 <- x2017data5.1.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.2 <- x2017season[88,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.2 <- x2017data5.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.2.1 <- x2017season[89,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.2.1 <- x2017data5.2.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.2.2 <- x2017season[90,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.2.2 <- x2017data5.2.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.5 <- x2017season[91,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.5. <- x2017data5.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.5.1 <- x2017season[92,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.5.1 <- x2017data5.5.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.5.2 <- x2017season[93,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.5.2 <- x2017data5.5.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.6 <- x2017season[94,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.6. <- x2017data5.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.6.1 <- x2017season[95,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.6.1 <- x2017data5.6.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.6.2 <- x2017season[96,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.6.2 <- x2017data5.6.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.6.3 <- x2017season[97,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.6.3 <- x2017data5.6.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.7 <- x2017season[98,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.7 <- x2017data5.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.7.1 <- x2017season[99,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.7.1 <- x2017data5.7.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data5.7.2 <- x2017season[100,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20175.7.2 <- x2017data5.7.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6 <- x2017season[101,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176 <- x2017data6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.1 <- x2017season[102,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.1 <- x2017data6.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.2 <- x2017season[103,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.2 <- x2017data6.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.3 <- x2017season[104,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.3 <- x2017data6.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.4 <- x2017season[105,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.4 <- x2017data6.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.5 <- x2017season[106,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.5 <- x2017data6.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.6 <- x2017season[107,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.6 <- x2017data6.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.7 <- x2017season[108,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.7 <- x2017data6.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.8 <- x2017season[109,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.8 <- x2017data6.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9 <- x2017season[110,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9 <- x2017data6.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.5 <- x2017season[111,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.5 <- x2017data6.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.6 <- x2017season[112,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.6 <- x2017data6.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.7 <- x2017season[113,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.7 <- x2017data6.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.8 <- x2017season[114,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.8 <- x2017data6.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9 <- x2017season[115,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9 <- x2017data6.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9.1 <- x2017season[116,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9.1 <- x2017data6.9.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9.2 <- x2017season[117,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9.2 <- x2017data6.9.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9.3 <- x2017season[118,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9.3 <- x2017data6.9.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9.4 <- x2017season[119,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9.4 <- x2017data6.9.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data6.9.5 <- x2017season[120,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20176.9.5 <- x2017data6.9.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))


x2016data <- rbind(x2016data, x2016data1, x2016data2, x2016data3, x2016data4, x2016data5, x2016data6, x2016data7, x2016data8, x2016data9, x2016data10, x2016data11, x2016data12, x2016data13, x2016data14, x2016data15)


x2017data7 <- x2017season[121,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177 <- x2017data7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1 <- x2017season[122,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1 <- x2017data7.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.2 <- x2017season[123,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.2 <- x2017data7.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.3 <- x2017season[124,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.3 <- x2017data7.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.4 <- x2017season[125,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.4 <- x2017data7.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.5 <- x2017season[126,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.5 <- x2017data7.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.6 <- x2017season[127,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.6 <- x2017data7.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.7 <- x2017season[128,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.7 <- x2017data7.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.8 <- x2017season[129,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.8 <- x2017data7.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.9 <- x2017season[130,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.9 <- x2017data7.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.1 <- x2017season[131,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.1 <- x2017data7.1.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.2 <- x2017season[132,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.2 <- x2017data7.1.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.3 <- x2017season[133,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.3 <- x2017data7.1.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.4 <- x2017season[134,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.4 <- x2017data7.1.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.5 <- x2017season[135,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.5 <- x2017data7.1.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.6 <- x2017season[136,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.6 <- x2017data7.1.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.7 <- x2017season[137,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.7 <- x2017data7.1.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.8 <- x2017season[138,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.8 <- x2017data7.1.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.1.9 <- x2017season[139,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.1.9 <- x2017data7.1.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data7.2.2 <- x2017season[140,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20177.2.2 <- x2017data7.2.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.1 <- x2017season[141,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.1 <- x2017data8.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.2 <- x2017season[142,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.2 <- x2017data8.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.3 <- x2017season[143,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.3 <- x2017data8.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.4 <- x2017season[144,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.4 <- x2017data8.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.5 <- x2017season[145,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.5 <- x2017data8.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.6 <- x2017season[146,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.6 <- x2017data8.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.7 <- x2017season[147,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.7 <- x2017data8.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.8 <- x2017season[148,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.8 <- x2017data8.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9 <- x2017season[149,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9 <- x2017data8.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.1 <- x2017season[150,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.1 <- x2017data8.9.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.2 <- x2017season[151,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.2 <- x2017data8.9.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.3 <- x2017season[152,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.3 <- x2017data8.9.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.4 <- x2017season[153,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.4 <- x2017data8.9.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.5 <- x2017season[154,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.5 <- x2017data8.9.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.6 <- x2017season[155,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.6 <- x2017data8.9.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.7 <- x2017season[156,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.7 <- x2017data8.9.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.8 <- x2017season[157,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.8 <- x2017data8.9.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.9 <- x2017season[158,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.9 <- x2017data8.9.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.9.1 <- x2017season[159,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.9.1 <- x2017data8.9.9.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data8.9.9.2 <- x2017season[160,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20178.9.9.2 <- x2017data8.9.9.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9 <- x2017season[161,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179 <- x2017data9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.1 <- x2017season[162,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.1 <- x2017data9.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.2 <- x2017season[163,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.2 <- x2017data9.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.3 <- x2017season[164,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.3 <- x2017data9.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.4 <- x2017season[165,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.4 <- x2017data9.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.5 <- x2017season[166,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.5 <- x2017data9.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.6 <- x2017season[167,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.6 <- x2017data9.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.7 <- x2017season[166,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.7 <- x2017data9.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.8 <- x2017season[167,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.8 <- x2017data9.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9 <- x2017season[168,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9 <- x2017data9.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.1 <- x2017season[169,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.1 <- x2017data9.9.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.2 <- x2017season[170,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.2 <- x2017data9.9.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.3 <- x2017season[171,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.3 <- x2017data9.9.3 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.4 <- x2017season[172,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.4 <- x2017data9.9.4 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.5 <- x2017season[173,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.5 <- x2017data9.9.5 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.6 <- x2017season[174,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.6 <- x2017data9.9.6 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.7 <- x2017season[175,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.7 <- x2017data9.9.7 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.8 <- x2017season[176,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.8 <- x2017data9.9.8 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.9 <- x2017season[177,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.9 <- x2017data9.9.9 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.9.1 <- x2017season[178,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.9.1 <- x2017data9.9.9.1 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data9.9.9.2 <- x2017season[179,] %>%
  group_by(start_date) %>%
  do(scrape_statcast_savant_pitcher_date(.$start_date, .$end_date)) %>%
  ungroup() %>%
  select(-start_date)

gc()

(missing_20179.9.9.2 <- x2017data9.9.9.2 %>%
  filter(is.na(pitch_type)) %>%
  distinct(game_date) %>%
  select(game_date))

x2017data <- rbind(x2017data1, x2017data1.1, x2017data1.1.1, x2017data1.2, x2017data1.3, x2017data2, x2017data2.1, x2017data2.1.1, x2017data2.1.2, x2017data2.2, x2017data2.3, x2017data3, x2017data3.1, x2017data3.2, x2017data3.3, x2017data3.4, x2017data3.5, x2017data4, x2017data4.1.1, x2017data4.1.2, x2017data4.1.3, x2017data4.1.4, x2017data4.2, x2017data4.2.1, x2017data4.2.2, x2017data4.2.3, x2017data4.3, x2017data4.3.1, x2017data4.3.2, x2017data4.3.3, x2017data4.4, x2017data4.5, x2017data4.6, x2017data4.7, x2017data4.8, x2017data5, x2017data5.1, x2017data5.1.1, x2017data5.1.2, x2017data5.1.3, x2017data5.1.4, x2017data5.1.5, x2017data5.2, x2017data5.2.1, x2017data5.2.2, x2017data5.5, x2017data5.5.1, x2017data5.5.2, x2017data5.6, x2017data5.6.1, x2017data5.6.2, x2017data5.6.3, x2017data5.7, x2017data5.7.1, x2017data5.7.2, x2017data6, x2017data6.1, x2017data6.2, x2017data6.3, x2017data6.4, x2017data6.5, x2017data6.6, x2017data6.7, x2017data6.8, x2017data6.9, x2017data6.9.1, x2017data6.9.2, x2017data6.9.3, x2017data6.9.4, x2017data6.9.5, x2017data8.1, x2017data8.2, x2017data8.3, x2017data8.4, x2017data8.5, x2017data8.6, x2017data8.7, x2017data8.8, x2017data8.9, x2017data8.9.1, x2017data8.9.2, x2017data8.9.3, x2017data8.9.4, x2017data8.9.5, x2017data8.9.6, x2017data8.9.7, x2017data8.9.8, x2017data8.9.9, x2017data8.9.9.1, x2017data8.9.9.2, x2017data9, x2017data9.1, x2017data9.2, x2017data9.3, x2017data9.4, x2017data9.5, x2017data9.6, x2017data9.7, x2017data9.8, x2017data9.9, x2017data9.9.1, x2017data9.9.2, x2017data9.9.3, x2017data9.9.4, x2017data9.9.5, x2017data9.9.6, x2017data9.9.7, x2017data9.9.8, x2017data9.9.9, x2017data9.9.9.1, x2017data9.9.9.2)


statcast_bind <- rbind(x2008data, x2009data, x2010data, x2011data, x2012data, x2013data, x2014data, x2015data, x2016data, x2017data)

statcast_bind$game_date <- as.character(statcast_bind$game_date)

statcast_bind <- statcast_bind %>%
  arrange(game_date)

statcast_bind <- statcast_bind %>%
  filter(!is.na(game_date))

write.csv(statcast_bind, "Statcast_2008_2017.csv")
write.csv(Statcast_2018, "Statcast_2018.csv")
```

```{r eval=FALSE, include=FALSE}
###########################################
library(readr)
library(dplyr)
library(data.table)
library(devtools)
devtools::source_gist("4959237")

Statcast_2018 <- read_csv("Statcast_2018.csv")
Statcast_2008_2017 <- read_csv("Statcast_2008_2017.csv")

colnames(Statcast_2008_2017)[colnames(Statcast_2008_2017)=="fielder_2.1"] <- "fielder_2_1"
colnames(Statcast_2008_2017)[colnames(Statcast_2008_2017)=="pitcher.1"] <- "pitcher_1"
Statcast_2018$X1_1 <- NULL
Statcast_2018$barrel <- NULL
Statcast_2008_2017$barrel <- NULL

statcast <- rbind(Statcast_2008_2017, Statcast_2018)

write.csv(statcast, "Statcast_2008_2018.csv")
write.csv(park_factors, "park_factors.csv")
write.csv(Gameday_Factors_2008_2018_, "Gamedayday_Factors_2008_2018.csv")
write.csv(Umpires, "Umpires.csv")
write.csv(Player_IDs, "Player_IDs.csv")
write.csv(League_wOBA_1871_2018_, "League_wOBA_1871_2018.csv")

umpires <- read_csv("Umpires.csv")
park_factors <- read_csv("park_factors.csv")
gameday <- read_csv("Gamedayday_Factors_2008_2018.csv")
player_ids <- read_csv("Player_IDs.csv")

statcast <- read_csv("Statcast_2008_2018.csv")

umpires <- umpires %>% filter(position == "HP")
colnames(umpires)[colnames(umpires)=="name"] <- "umpire_hp"
umpires$id <- NULL
umpires$position <- NULL
umpires$X1 <- NULL
```

```{r eval=FALSE, include=FALSE}
statcast$X1_1 <- NULL
statcast$spin_rate_deprecated <- NULL
statcast$break_angle_deprecated <- NULL 
statcast$break_length_deprecated <- NULL
statcast$spin_dir <- NULL
statcast$tfs_deprecated <- NULL
statcast$tfs_zulu_deprecated <- NULL
statcast$fielder_2_1 <- NULL
statcast$umpire <- NULL
statcast$pitcher_1 <- NULL
statcast$X1 <- NULL
statcast$pitch_name <- NULL
statcast$pitcher <- NULL
statcast$des <- NULL
statcast$game_type <- NULL
statcast$game_year <- NULL
statcast$on_3b <- NULL
statcast$on_2b <- NULL
statcast$on_1b <- NULL
statcast$outs_when_up <- NULL
statcast$inning <- NULL
statcast$inning_topbot <- NULL
statcast$fielder_2 <- NULL
statcast$fielder_3 <- NULL
statcast$fielder_4 <- NULL
statcast$fielder_5 <- NULL
statcast$fielder_6 <- NULL
statcast$fielder_7 <- NULL
statcast$fielder_8 <- NULL
statcast$fielder_9 <- NULL
statcast$sv_id <- NULL
statcast$home_score <- NULL
statcast$away_score <- NULL
statcast$bat_score <- NULL
statcast$fld_score <- NULL
statcast$post_away_score <- NULL
statcast$post_home_score <- NULL
statcast$post_bat_score <- NULL
statcast$post_fld_score <- NULL

write.csv(statcast, "Statcast_2008_2018.csv")

library(sqldf)
gamefactors <- sqldf("SELECT game_pk, game_date, venue_name, temperature, other_weather, wind, umpire_hp
              FROM gameday
              JOIN umpires USING(game_date, game_pk)")

bat_player_ids <- filter(player_ids, mlb_pos != "P")
pit_player_ids <- filter(player_ids, mlb_pos == "P")
colnames(bat_player_ids)[colnames(bat_player_ids)=="mlb_id"] <- "batter"
colnames(bat_player_ids)[colnames(bat_player_ids)=="mlb_name"] <- "batter_name"
colnames(pit_player_ids)[colnames(pit_player_ids)=="mlb_name"] <- "pitcher"
colnames(pit_player_ids)[colnames(pit_player_ids)=="birth_year"] <- "pit_birth_year"
bat_player_ids <- subset(bat_player_ids, select = c("batter", "batter_name", "birth_year"))
statcast <- merge(statcast, bat_player_ids, by = "batter")
statcast$batter <- NULL
pit_player_ids <- subset(pit_player_ids, select = c("pitcher", "pit_birth_year"))
colnames(statcast)[colnames(statcast)=="pitcher"] <- "pitcher"
statcast <- merge(statcast, pit_player_ids, by = "pitcher")

## Add column to "statcast" for "game_pk"
## Create dataframe "parks" with columns "home_team" (abbreviation) and "game_pk" (id)

parks <- gamefactors %>% select(game_date, game_pk, venue_name)
parks <- parks[!(parks$game_date == "2014-03-22"),]
parks1 <- gamefactors %>% select(game_date, game_pk, venue_name)
names1 <- unique(parks1$venue_name)

names <- unique(parks$venue_name)
venue_name <- names[! names %in% "Williamsport Little League Classic"]
abbr <- unique(statcast$home_team)


home_team <- c("LAD", "CHC","BOS", "NYM","SF", "BAL","MIL", "KC","SEA", "TB", "COL", "CIN", "MIN", "SD", "PHI", "LAA", "STL", "WSH", "ARI", "TOR", "CWS", "MIA", "NYY", "CLE", "TEX", "ATL", "HOU", "OAK", "PIT", "DET", "PHI", "LAA", "SD", "MIN", "CWS", "ATL", "NYM", "ATL", "OAK", "TEX") 

parkguide <- rbind(home_team, venue_name)
df1 <- data.frame(parkguide)
m1 <- t(df1)
parkguide <- data.frame(r1= row.names(m1), m1, row.names=NULL) 

parkguide <- sqldf("SELECT game_pk, game_date, venue_name, home_team 
              FROM parks
              JOIN parkguide USING(venue_name)")

statcast <- statcast[!(statcast$game_date == "2014-03-22"),]
colnames(statcast)[colnames(statcast)== "pitcher"] <- "pitcher"

gamefactors <- gamefactors[!(gamefactors$game_date == "2014-03-22"),]
gamefactors <- gamefactors[!(gamefactors$venue_name == "Williamsport Little League Classic"),]

gamefactors <- bind_cols(parkguide, gamefactors)
gamefactors$game_pk1 <- NULL
gamefactors$game_date1 <- NULL
gamefactors$venue_name1 <- NULL



## I actually only need to merge "gamefactors" and "statcast" for 2017 and 2018. The original "statcast" can be used for stats without park factors being known.

colnames(statcast)[colnames(statcast)== "batter_name"] <- "batter"
statcast_2017_2018 <- statcast %>% filter(game_date <= "2018-10-01", game_date >= "2017-04-02")

statcast_2017_2018 <- sqldf("SELECT game_pk, game_date, home_team, away_team, venue_name, temperature, other_weather, wind, umpire_hp, pitch_type, release_speed, release_pos_x, release_pos_z, release_pos_y, pitcher, batter, events, description, stand, p_throws, type, bb_type, balls, strikes, pfx_x, pfx_z, plate_x, plate_z, vx0, vy0, vz0, ax, ay, az, sz_top, sz_bot, effective_speed, release_spin_rate, release_extension, pitch_number, zone, bb_type
              FROM statcast_2017_2018
              JOIN gamefactors USING(game_date, home_team, game_pk)")

write.csv(statcast_2017_2018, "Statcast_2017_2018.csv")
statcast_2017_2018 <- read_csv("Statcast_2017_2018.csv")

## "other_weather" - categorical:

## dome = 0
## roof closed = 1
## sunny = 2
## clear = 3
## partly cloudy = 4
## cloudy = 5
## overcast = 6
## drizzle = 7
## rain = 8
## snow = 9

statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "dome"] <- "0"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "roof closed"] <- "1"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "sunny"] <- "2"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "clear"] <- "3"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "partly cloudy"] <- "4"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "cloudy"] <- "5"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "overcast"] <- "6"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "drizzle"] <- "7"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "rain"] <- "8"
statcast_2017_2018$other_weather[statcast_2017_2018$other_weather == "snow"] <- "9"
```

```{r eval=FALSE, include=FALSE}
## Wind speed (mph), vector
wind_speed <- sub("[^0-9].*", "", statcast_2017_2018$wind)

## Rename wind directions:
wind_dir <- sub("[0-9].* mph,\\s", "", statcast_2017_2018$wind)

statcast_2017_2018$wind_dir <- wind_dir
statcast_2017_2018$wind_speed <- wind_speed

## Out to CF = 4

statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "Out to CF"] <- "4"
## R to L = 5
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "R to L"] <- "5"
## Out to RF = 6
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "Out to RF"] <- "6"
## Out to LF = 7
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "Out to LF"] <- "7"
## Varies = 3
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "Varies"] <- "3"
## None (rename none and 0 mph) = 1
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "None"] <- "1"
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "none"] <- "1"
## Calm = 2
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "Calm"] <- "2"
## L to R = 8
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "L to R"] <- "3"
## In from CF = 9
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "In from CF"] <- "9"
## In from LF = 10
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "In from LF"] <- "10"
## In from RF = 11
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "In from RF"] <- "11"
## Indoors = 0
statcast_2017_2018$wind_dir[statcast_2017_2018$wind_dir == "Indoors"] <- "0"

## "type" - categorical

## X = 2
statcast_2017_2018$type[statcast_2017_2018$type == "X"] <- "2"
## B = 1
statcast_2017_2018$type[statcast_2017_2018$type == "B"] <- "1"
## S = 0
statcast_2017_2018$type[statcast_2017_2018$type == "S"] <- "0"

## "stand" - categorical

## L = 1
statcast_2017_2018$stand[statcast_2017_2018$stand == "L"] <- "1"
## R = 0
statcast_2017_2018$stand[statcast_2017_2018$stand == "R"] <- "0"

## p_throws - categorical

## L = 1
statcast_2017_2018$p_throws[statcast_2017_2018$p_throws == "L"] <- "1"
## R = 0
statcast_2017_2018$p_throws[statcast_2017_2018$p_throws == "R"] <- "0"

colnames(statcast_2017_2018)[colnames(statcast_2017_2018)== "bb_type_1"] <- "bb_type"

## pitch_type - categorical

## "FF"
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "FF"] <- "0"
## "CU"  
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "CU"] <- "1"
## "CH"   
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "CH"] <- "2"
## "FC"   
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "FC"] <- "3"
## "SL"   
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "SL"] <- "4"
## "KC"   
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "KC"] <- "5"
## "FT"   
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "FT"] <- "6"
## "FS"  
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "FS"] <- "7"
## "SI"  
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "SI"] <- "8"
## "null" 
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "null"] <- "NA"
## "FO"   
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "FO"] <- "9"
## "PO"  
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "PO"] <- "10"
## "EP"  
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "EP"] <- "11"
## "KN"
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "KN"] <- "12"
## "UN"
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "UN"] <- "13"
## "SC"
statcast_2017_2018$pitch_type[statcast_2017_2018$pitch_type == "SC"] <- "14"

write.csv(statcast_2017_2018, "Statcast_2017_2018.csv")

statcast_2008_2018 <- statcast

## Clean 2008-2018
## "type" - categorical

## X = 2
statcast_2008_2018$type[statcast_2008_2018$type == "X"] <- "2"
## B = 1
statcast_2008_2018$type[statcast_2008_2018$type == "B"] <- "1"
## S = 0
statcast_2008_2018$type[statcast_2008_2018$type == "S"] <- "0"

## "stand" - categorical

## L = 1
statcast_2008_2018$stand[statcast_2008_2018$stand == "L"] <- "1"
## R = 0
statcast_2008_2018$stand[statcast_2008_2018$stand == "R"] <- "0"

## p_throws - categorical

## L = 1
statcast_2008_2018$p_throws[statcast_2008_2018$p_throws == "L"] <- "1"
## R = 0
statcast_2008_2018$p_throws[statcast_2008_2018$p_throws == "R"] <- "0"

## pitch_type - categorical

## "FF"
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "FF"] <- "0"
## "CU"  
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "CU"] <- "1"
## "CH"   
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "CH"] <- "2"
## "FC"   
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "FC"] <- "3"
## "SL"   
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "SL"] <- "4"
## "KC"   
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "KC"] <- "5"
## "FT"   
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "FT"] <- "6"
## "FS"  
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "FS"] <- "7"
## "SI"  
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "SI"] <- "8"
## "null" 
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "null"] <- "NA"
## "FO"   
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "FO"] <- "9"
## "PO"  
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "PO"] <- "10"
## "EP"  
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "EP"] <- "11"
## "KN"
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "KN"] <- "12"
## "UN"
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "UN"] <- "13"
## "SC"
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "SC"] <- "14"
## "IN"
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "IN"] <- "15"
## "FA"
statcast_2008_2018$pitch_type[statcast_2008_2018$pitch_type == "FA"] <- "16"


## "events" - categorical

## no contact = 0
## contact = 1
## Homerun = 2
## Hit by pitch = 3
## Walk = 4 
## Strikeout = 5
## unknown = NA
## bunt = 6

## More generally: Contact = 1 or 2, No Contact = 0, 3, 4, 5, or 6, Walk = 3 or 4, End of PA = 1, 2, 3, 4, 5

## "field_out" = 1 
statcast_2008_2018$events[statcast_2008_2018$events == "field_out"] <- "1"
## "null" = 0    
statcast_2008_2018$events[statcast_2008_2018$events == "null"] <- "0"
## "single" = 1  
statcast_2008_2018$events[statcast_2008_2018$events == "single"] <- "1"
## "double" = 1  
statcast_2008_2018$events[statcast_2008_2018$events == "double"] <- "1"
## "strikeout" = 5 
statcast_2008_2018$events[statcast_2008_2018$events == "strikeout"] <- "5"
## "walk" = 4      
statcast_2008_2018$events[statcast_2008_2018$events == "walk"] <- "4"
## "intent_walk" = 4 
statcast_2008_2018$events[statcast_2008_2018$events == "intent_walk"] <- "4"
## "sac_bunt" = 6   
statcast_2008_2018$events[statcast_2008_2018$events == "sac_bunt"] <- "6"
## "home_run" = 2  
statcast_2008_2018$events[statcast_2008_2018$events == "home_run"] <- "2"
## "grounded_into_double_play" = 1 
statcast_2008_2018$events[statcast_2008_2018$events == "grounded_into_double_play"] <- "1"
## "force_out" = 1           
statcast_2008_2018$events[statcast_2008_2018$events == "force_out"] <- "1"
## "hit_by_pitch" = 3  
statcast_2008_2018$events[statcast_2008_2018$events == "hit_by_pitch"] <- "3"
## "field_error" = 1  
statcast_2008_2018$events[statcast_2008_2018$events == "field_error"] <- "1"
## "double_play" = 1   
statcast_2008_2018$events[statcast_2008_2018$events == "double_play"] <- "1"
## "sac_fly" = 1   
statcast_2008_2018$events[statcast_2008_2018$events == "sac_fly"] <- "1"
## "triple" = 1   
statcast_2008_2018$events[statcast_2008_2018$events == "triple"] <- "1"
## "strikeout_double_play" = 5  
statcast_2008_2018$events[statcast_2008_2018$events == "strikeout_double_play"] <- "5"
## "caught_stealing_2b" = 0   
statcast_2008_2018$events[statcast_2008_2018$events == "caught_stealing_2b"] <- "0"
## "caught_stealing_home" = 0  
statcast_2008_2018$events[statcast_2008_2018$events == "caught_stealing_home"] <- "0"
## "other_out" = 0             
statcast_2008_2018$events[statcast_2008_2018$events == "other_out"] <- "0"
## "fielders_choice" = 1      
statcast_2008_2018$events[statcast_2008_2018$events == "fielders_choice"] <- "1"
## "fielders_choice_out" = 1      
statcast_2008_2018$events[statcast_2008_2018$events == "fielders_choice_out"] <- "1"
## "pickoff_caught_stealing_2b" = 0 
statcast_2008_2018$events[statcast_2008_2018$events == "pickoff_caught_stealing"] <- "0"
## "sac_fly_double_play" = 1       
statcast_2008_2018$events[statcast_2008_2018$events == "sac_fly_double_play"] <- "1"
## "pickoff_1b" = 0                
statcast_2008_2018$events[statcast_2008_2018$events == "pickoff_1b"] <- "0"
## "catcher_interf" = 1            
statcast_2008_2018$events[statcast_2008_2018$events == "catcher_interf"] <- "1"
## "caught_stealing_3b" = 0          
statcast_2008_2018$events[statcast_2008_2018$events == "caught_stealing_3b"] <- "0"
## "run" = 0                         
statcast_2008_2018$events[statcast_2008_2018$events == "run"] <- "0"
## "sac_bunt_double_play" = 6   
statcast_2008_2018$events[statcast_2008_2018$events == "sac_bunt_double_play"] <- "6"
## "triple_play" = 1               
statcast_2008_2018$events[statcast_2008_2018$events == "triple_play"] <- "1"
## "batter_interference" = 0         
statcast_2008_2018$events[statcast_2008_2018$events == "batter_interference"] <- "0"
## "pickoff_2b" = 0                
statcast_2008_2018$events[statcast_2008_2018$events == "pickoff_2b"] <- "0"
## "pickoff_caught_stealing_3b" = 0  
statcast_2008_2018$events[statcast_2008_2018$events == "pickoff_caught_stealing_home"] <- "0"
## "pickoff_caught_stealing_home" = 0
statcast_2008_2018$events[statcast_2008_2018$events == "pickoff_caught_stealing_home"] <- "0"
## "pickoff_3b" = 0                  
statcast_2008_2018$events[statcast_2008_2018$events == "pickoff_3b"] <- "0"
## "at_bat_start" = 1               
statcast_2008_2018$events[statcast_2008_2018$events == "at_bat_start"] <- "1"
## "offensive_substitution" = 1     
statcast_2008_2018$events[statcast_2008_2018$events == "offensive_substitution"] <- "1"
## "umpire_substitution" = 1 
statcast_2008_2018$events[statcast_2008_2018$events == "umpire_substitution"] <- "1"

## "description" - categorical

## No swing = 0
## Hit = 1
## Whiffs = 2
## Foul = 3
## Unknown strike = 4

## Swings = 1,2,3, and End of PA = 1

## "hit_into_play" = 1  
statcast_2008_2018$description[statcast_2008_2018$description == "hit_into_play"] <- "1"
## "ball" = 0   
statcast_2008_2018$description[statcast_2008_2018$description == "ball"] <- "0"
## "hit_into_play_no_out" = 1  
statcast_2008_2018$description[statcast_2008_2018$description == "hit_into_play_no_out"] <- "1"
## "called_strike" = 0   
statcast_2008_2018$description[statcast_2008_2018$description == "called_strike"] <- "0"
## "hit_into_play_score" = 1 
statcast_2008_2018$description[statcast_2008_2018$description == "hit_into_play_score"] <- "1"
## "swinging_strike" = 2   
statcast_2008_2018$description[statcast_2008_2018$description == "swinging_strike"] <- "1"
## "blocked_ball" = 0   
statcast_2008_2018$description[statcast_2008_2018$description == "blocked_ball"] <- "0"
## "foul" = 3        
statcast_2008_2018$description[statcast_2008_2018$description == "foul"] <- "3"
## "intent_ball" = 0  
statcast_2008_2018$description[statcast_2008_2018$description == "intent_ball"] <- "0"
## "foul_tip" = 3     
statcast_2008_2018$description[statcast_2008_2018$description == "foul_tip"] <- "3"
## "missed_bunt" = 0    
statcast_2008_2018$description[statcast_2008_2018$description == "missed_bunt"] <- "0"
## "swinging_strike_blocked" = 2  
statcast_2008_2018$description[statcast_2008_2018$description == "swinging_strike_blocked"] <- "2"
## "hit_by_pitch" = 0         
statcast_2008_2018$description[statcast_2008_2018$description == "hit_by_pitch"] <- "0"
## "foul_bunt" = 3          
statcast_2008_2018$description[statcast_2008_2018$description == "foul_bunt"] <- "3"
## "pitchout" = 0                   
statcast_2008_2018$description[statcast_2008_2018$description == "pitchout"] <- "0"
## "pitchout_hit_into_play_no_out" = 1
statcast_2008_2018$description[statcast_2008_2018$description == "pitchout_hit_into_play_no_out"] <- "1"
## "swinging_pitchout" = 2          
statcast_2008_2018$description[statcast_2008_2018$description == "swinging_pitchout"] <- "2"
## "pitchout_hit_into_play_score" = 1
statcast_2008_2018$description[statcast_2008_2018$description == "pitchout_hit_into_play_score"] <- "1"
## "pitchout_hit_into_play" = 1      
statcast_2008_2018$description[statcast_2008_2018$description == "pitchout_hit_into_play"] <- "1"
## "foul_pitchout" = 3           
statcast_2008_2018$description[statcast_2008_2018$description == "foul_pitchout"] <- "3"
## "unknown_strike" = 4
statcast_2008_2018$description[statcast_2008_2018$description == "unknown_strike"] <- "4"

## bb_type - categorical

## Contact = 1
## No contact = 0

## "ground_ball" 
statcast_2008_2018$bb_type[statcast_2008_2018$bb_type == "ground_ball"] <- "1"
## "null"   
statcast_2008_2018$bb_type[statcast_2008_2018$bb_type == "null"] <- "0"
## "line_drive"  
statcast_2008_2018$bb_type[statcast_2008_2018$bb_type == "line_drive"] <- "1"
## "fly_ball"    
statcast_2008_2018$bb_type[statcast_2008_2018$bb_type == "fly_ball"] <- "1"
## "popup"    
statcast_2008_2018$bb_type[statcast_2008_2018$bb_type == "popup"] <- "1"

## remove unused columns

statcast_2008_2018$release_pos_x <- NULL
statcast_2008_2018$release_pos_z <- NULL
statcast_2008_2018$release_pos_y <- NULL
statcast_2008_2018$hit_location <- NULL
statcast_2008_2018$hit_distance_sc <- NULL
statcast_2008_2018$hc_x <- NULL
statcast_2008_2018$hc_y <- NULL
statcast_2008_2018$estimated_ba_using_speedangle <- NULL
statcast_2008_2018$estimated_woba_using_speedangle <- NULL
statcast_2008_2018$woba_value <- NULL
statcast_2008_2018$woba_denom <- NULL
statcast_2008_2018$babip_value <- NULL
statcast_2008_2018$iso_value <- NULL
statcast_2008_2018$if_fielding_alignment <- NULL
statcast_2008_2018$of_fielding_alignment <- NULL
statcast_2008_2018$launch_speed <- NULL
statcast_2008_2018$launch_angle <- NULL
statcast_2008_2018$vx0 <- NULL
statcast_2008_2018$vy0 <- NULL
statcast_2008_2018$vz0<- NULL
statcast_2008_2018$ax <- NULL
statcast_2008_2018$ay <- NULL
statcast_2008_2018$az <- NULL
```

```{r eval=FALSE, include=FALSE}
## Turn strikezone width into range from (-100%, 100%)
statcast_2008_2018 <- read_csv("Statcast_2008_2018.csv")

statcast_2008_2018$plate_x[statcast_2008_2018$plate_x >= 0 & !is.na(statcast_2008_2018$plate_x)] <- (statcast_2008_2018$plate_x[statcast_2008_2018$plate_x >= 0 & !is.na(statcast_2008_2018$plate_x)]/9.95)*100

statcast_2008_2018$plate_x[statcast_2008_2018$plate_x <= 0 & !is.na(statcast_2008_2018$plate_x)] <- (statcast_2008_2018$plate_x[statcast_2008_2018$plate_x <= 0 & !is.na(statcast_2008_2018$plate_x)]/9.95)*100

## Finding the new position of the ball over the new strikezone top (3.5 feet)

over <- filter(statcast_2008_2018, (abs(plate_z) - sz_top) > 0) %>% select(plate_x, plate_z, sz_top, sz_bot, release_spin_rate, game_date, pitch_number, X1)

over$adj <- over$plate_z - over$sz_top
over$adj <- over$adj + 3.5
over$adj <- over$adj

## "new.col" has the adjusted pitch height above the strikezone

## Finding the adjusted ball position under the new strikezone bottom (1.5 feet)
under <- filter(statcast_2008_2018, (sz_bot - abs(plate_z)) > 0) %>% select(plate_x, plate_z, sz_top, sz_bot, release_spin_rate, game_date, pitch_number, X1)

under$adj <- (under$plate_z/under$sz_bot)*1.5

## "adj" has the adjusted pitch height below the strikezone

## Finding the adjusted ball position inside the new stikezone

inside <- filter(statcast_2008_2018, (abs(plate_z) - sz_bot) >= 0, (abs(plate_z) - sz_top) <= 0) %>% select(plate_x, plate_z, sz_top, sz_bot, release_spin_rate, game_date, pitch_number, X1)

inside$adj <- (inside$plate_z/inside$sz_top)*3.5

## "adj" has the adjusted pitch height inside the strikezone

adjusted <- rbind(over, under, inside)

adjusted$adj[adjusted$adj >= 0] <- (adjusted$adj[adjusted$adj >= 0]/3.5)*100
adjusted$adj[adjusted$adj <= 0] <- (adjusted$adj[adjusted$adj <= 0]/1.5)*100

## Splitting the strikezone into "zones" (see Tango for diagram)

zone.3 <- filter(adjusted, plate_x >= 33.3333, plate_x <= 70, adj >= 33.3333, adj < 70)
zone.3$zone <- 3
zone.6 <- filter(adjusted, plate_x >= 33.3333, plate_x <= 70, adj >= -33.3333, adj < 33.3333)
zone.6$zone <- 6
zone.9 <- filter(adjusted, plate_x >= 33.3333, plate_x <= 70, adj >= -70, adj < -33.3333)
zone.9$zone <- 9
zone.2 <- filter(adjusted, plate_x > -33.3333, plate_x < 33.3333, adj >= 33.3333, adj < 70)
zone.2$zone <- 2
zone.5 <- filter(adjusted, plate_x > -33.3333, plate_x < 33.3333, adj >= -33.3333, adj < 33.3333)
zone.5$zone <- 5
zone.8 <- filter(adjusted, plate_x > -33.3333, plate_x < 33.3333, adj >= -70, adj < -33.3333)
zone.8$zone <- 8
zone.1 <- filter(adjusted, plate_x >= -70, plate_x <= -33.3333, adj >= 33.3333, adj < 70)
zone.1$zone <- 1
zone.4 <- filter(adjusted, plate_x >= -70, plate_x <= -33.3333, adj >= -33.3333, adj < 33.3333)
zone.4$zone <- 4
zone.7 <- filter(adjusted, plate_x >= -70, plate_x <= -33.3333, adj >= -70, adj < -33.3333)
zone.7$zone <- 7
zone.18 <- filter(adjusted, plate_x >= -70, plate_x <= 70, adj >= -100, adj < -70)
zone.18$zone <- 18
zone.12 <- filter(adjusted, plate_x >= -70, plate_x <= 70, adj >= 70, adj < 100)
zone.12$zone <- 12
zone.14 <- filter(adjusted, plate_x > -100, plate_x < -70, adj >= -70, adj <= 70)
zone.14$zone <- 14
zone.16 <- filter(adjusted, plate_x > 70, plate_x < 100, adj >= -70, adj <= 70)
zone.16$zone <- 16
zone.19 <- filter(adjusted, plate_x > 70, plate_x < 100, adj >= -100, adj < -70)
zone.13 <- filter(adjusted, plate_x > 70, plate_x < 100, adj >= 70, adj < 100)
zone.13$zone <- 13
zone.17 <- filter(adjusted, plate_x >= -100, plate_x <= -70, adj >= -100, adj < -70)
zone.11 <- filter(adjusted, plate_x >= -100, plate_x <= -70, adj >= 70, adj < 100)
zone.11$zone <- 11
zone.24 <- filter(adjusted, plate_x >= -130, plate_x <= -100, adj >= -70, adj <= 70)
zone.26 <- filter(adjusted, plate_x >= 100, plate_x <= 130, adj >= -70, adj <= 70)
zone.26$zone <- 26
zone.28 <- filter(adjusted, plate_x >= -70, plate_x <= 70, adj >= -130, adj < -100)
zone.28$zone <- 28
zone.22 <- filter(adjusted, plate_x >= -70, plate_x <= 70, adj >= 100, adj <= 130)
zone.22$zone <- 22
zone.27 <- filter(adjusted, plate_x >= -130, plate_x <= -70, adj >= -130, adj <= -70)
zone.27 <- filter(zone.27, !(plate_x >= -100 & plate_x <= -70 & adj >= -100 & adj <= -70))
zone.27$zone <- 27
zone.21 <- filter(adjusted, plate_x >= -130, plate_x <= -70, adj >= 70, adj <= 130)
zone.21 <- filter(zone.21, !(plate_x >= -100 & plate_x <= -70 & adj >= 70 & adj <= 100))
zone.21$zone <- 21
zone.23 <- filter(adjusted, plate_x > 70, plate_x <= 130, adj >= 70, adj <= 130)
zone.23 <- filter(zone.23, !(plate_x > 70 & plate_x < 100 & adj >= 70 & adj <= 100))
zone.23$zone <- 23
zone.29 <- filter(adjusted, plate_x >= 70, plate_x <= 130, adj >= -130, adj <= -70)
zone.29 <- filter(zone.29, !(plate_x >= 70 & plate_x < 100 & adj >= -100 & adj <= -70))
zone.30 <- filter(adjusted, plate_x > 130 | plate_x < -130 | adj > 130 | adj < -130)
zone.30$zone <- 30

zones <- rbind(zone.1, zone.2, zone.3, zone.4, zone.5, zone.6, zone.7, zone.8, zone.9, zone.11, zone.12, zone.13, zone.14, zone.16, zone.17, zone.18, zone.19, zone.21, zone.22, zone.23, zone.24, zone.26, zone.27, zone.28, zone.29, zone.30)
```

```{r eval=FALSE, include=FALSE}
colnames(zones)[colnames(zones)== "zone"] <- "zones"
colnames(zones)[colnames(zones)== "plate_x"] <- "horiz_adj"
colnames(zones)[colnames(zones)== "adj"] <- "vert_adj"

statcast_2008_2018 <- merge(statcast_2008_2018, zones, by = c("plate_z", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "X1"))

write.csv(statcast_2008_2018, "Statcast_2008_2018.csv")
statcast_2008_2018 <- read_csv("Statcast_2008_2018.csv")
```

```{r eval=FALSE, include=FALSE}
colnames(statcast_2008_2018)[colnames(statcast_2008_2018)== "player_name"] <- "pitcher"
statcast_2008_2018$zone <- NULL
colnames(statcast_2008_2018)[colnames(statcast_2008_2018)== "zones"] <- "zone"
```

```{r eval=FALSE, include=FALSE}
## Number of career hits (contacts), using bb_type, for each batter (from 2017 and 2018)
get_hits_bat <- function(x){
  hit <- filter(statcast_2008_2018, batter == x, bb_type == 1)
  hits <- nrow(hit)
  return(hits)
}

hits_bat <- function(batter){
  hitters <- unique(statcast_2017_2018$batter)
  x <- lapply(hitters, get_hits_bat)

  return(x)
}

mat_hits_bat <- hits_bat(batter)

## Hits per pitcher

get_hits_pit <- function(x){
  hit <- filter(statcast_2008_2018, pitcher == x, bb_type == 1)
  hits <- nrow(hit)
  return(hits)
}

hits_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_hits_pit)

  return(x)
}

mat_hits_pit <- hits_pit(pitcher)

## Number of games for each batter
batter_games <- function(x){
  a <- filter(statcast_2008_2018, batter == x)
  g <- length(unique(a$game_date))
  return(g)
}

games_bat <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, batter_games)

  return(x)
}

mat_g_bat <- games_bat(batter)

## Number of games for each pitcher

pitcher_games <- function(x){
  a <- filter(statcast_2008_2018, pitcher == x)
  games <- length(unique(a$game_date))
  return(games)
}

games_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitcher_games)

  return(x)
}

mat_g_pit <- games_pit(pitcher)

## PA per batter

get_PA <- function(x){
  app <- filter(statcast_2008_2018, batter == x, pitch_number == 1)
  PA <- nrow(app)
  return(PA)
}

PA <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, get_PA)

  return(x)
}

mat_pa <- PA(batter)

## HR per pitcher (for FIP)

get_HR <- function(x){
  run <- filter(statcast_2008_2018, pitcher == x, events == 2)
  HR <- nrow(run)
  return(HR)
}

HR <- function(pitcher){
  run <- unique(statcast_2017_2018$pitcher)
  x <- lapply(run, get_HR)
 
  return(x)
}

mat_hr <- HR(pitcher)

## HBP per batter

get_HBP <- function(x){
  hit <- filter(statcast_2008_2018, batter == x, events == 3)
  HBP <- nrow(hit)
  return(HBP)
}

HBP <- function(batter){
  batter <- unique(statcast_2017_2018$batter)
  x <- lapply(batter, get_HBP)

  return(x)
}

mat_hbp <- HBP(batter)

## Walks per batter

get_BB_bat <- function(x){
  walk <- filter(statcast_2008_2018, batter == x, events == 4)
  BB <- nrow(walk)
  return(BB)
}

BB_bat <- function(batter){
  batter <- unique(statcast_2017_2018$batter)
  x <- lapply(batter, get_BB_bat)

  return(x)
}

mat_bb_bat <- BB_bat(batter)

## Walks per pitcher

get_BB_pit <- function(x){
  walk <- filter(statcast_2008_2018, pitcher == x, events == 4)
  BB <- nrow(walk)
  return(BB)
}

BB_pit <- function(pitcher){
  pitcher <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitcher, get_BB_pit)

  return(x)
}

mat_bb_pit <- BB_pit(pitcher)

## Strikeout per batter

get_SO_bat <- function(x){
  K <- filter(statcast_2008_2018, batter == x, events == 5)
  SO <- nrow(K)
  return(SO)
}

SO_bat <- function(batter){
  batter <- unique(statcast_2017_2018$batter)
  x <- lapply(batter, get_SO_bat)

  return(x)
}

mat_so_bat <- SO_bat(batter)

## Strikeouts per pitcher

get_SO_pit <- function(x){
  K <- filter(statcast_2008_2018, pitcher == x, events == 5)
  SO <- nrow(K)
  return(SO)
}

SO_pit <- function(pitcher){
  pitcher <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitcher, get_SO_pit)

  return(x)
}

mat_so_pit <- SO_pit(pitcher)

## IP for a given pitcher

get_IP <- function(x){
  innings <- filter(statcast_2008_2018, pitcher == x, pitch_number == 1)
  IP <- nrow(innings)/3
  return(IP)
}

IP <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_IP)

  return(x)
}

mat_ip <- IP(pitcher)

## Swings per batter

get_swings_bat <- function(x){
  swing <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3)
  swings <- nrow(swing)
  return(swings)
}

swings_bat <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, get_swings_bat)

  return(x)
}

mat_swings_bat <- swings_bat(batter)

## Swings per pitcher

get_swings_pit <- function(x){
  swing <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3)
  swings <- nrow(swing)
  return(swings)
}

swings_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_swings_pit)

  return(x)
}

mat_swings_pit <- swings_pit(pitcher)

## Whiffs per batter

get_whiffs_bat <- function(x){
  whiff <- filter(statcast_2008_2018, batter == x, description == 2)
  whiffs <- nrow(whiff)
  return(whiffs)
}

whiffs_bat <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, get_whiffs_bat)
  return(x)
}

mat_whiffs_bat <- whiffs_bat(batter)

## Whiffs per pitcher

get_whiffs_pit <- function(x){
  whiff <- filter(statcast_2008_2018, pitcher == x, description == 2)
  whiffs <- nrow(whiff)
  return(whiffs)
}

whiffs_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_whiffs_pit)
  return(x)
}

mat_whiffs_pit <- whiffs_pit(pitcher)

## Batters faced by pitcher

get_bf_pit <- function(x){
  batters <- filter(statcast_2008_2018, pitcher == x, pitch_number == 1)
  faced <- nrow(batters)
  return(faced)
}

bf_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_bf_pit)
  return(x)
}

mat_bf_pit <- bf_pit(pitcher)

batters <- unique(statcast_2017_2018$batter)
pitchers <- unique(statcast_2017_2018$pitcher)


bi_pitcht_stats <- data.frame(batter = unlist(batters), Car_bat_H=unlist(mat_hits_bat), Car_bat_G=unlist(mat_g_bat), Car_bat_PA=unlist(mat_pa), Car_bat_HBP=unlist(mat_hbp), Car_bat_BB=unlist(mat_bb_bat), Car_bat_K=unlist(mat_so_bat), Car_bat_Swings=unlist(mat_swings_bat), Car_bat_Whiffs=unlist(mat_whiffs_bat))


car_pit_stats <- data.frame(pitcher=unlist(pitchers), Car_pit_Whiffs=unlist(mat_whiffs_pit), Car_pit_Swings=unlist(mat_swings_pit), Car_pit_IP=unlist(mat_ip), Car_pit_K=unlist(mat_so_pit), Car_pit_BB=unlist(mat_bb_pit), Car_pit_HR=unlist(mat_hr), Car_pit_G=unlist(mat_g_pit), Car_pit_H=unlist(mat_hits_pit), Car_pit_BF=unlist(mat_bf_pit))


## 2017-2018 basics:


## Number of career hits (contacts), using bb_type, for each batter (from 2017 and 2018)
get_hits_bat <- function(x){
  hit <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, bb_type == 1)
  hits <- nrow(hit)
  return(hits)
}

hits_bat <- function(batter){
  hitters <- unique(statcast_2017_2018$batter)
  x <- lapply(hitters, get_hits_bat)

  return(x)
}

mat_hits_bat <- hits_bat(batter)

## Hits per pitcher

get_hits_pit <- function(x){
  hit <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, bb_type == 1)
  hits <- nrow(hit)
  return(hits)
}

hits_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_hits_pit)

  return(x)
}

mat_hits_pit <- hits_pit(pitcher)


## Number of games for each batter
batter_games <- function(x){
  a <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x)
  g <- length(unique(a$game_date))
  return(g)
}

games_bat <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, batter_games)

  return(x)
}

mat_g_bat <- games_bat(batter)

## Number of games for each pitcher

pitcher_games <- function(x){
  a <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x)
  games <- length(unique(a$game_date))
  return(games)
}

games_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitcher_games)

  return(x)
}

mat_g_pit <- games_pit(pitcher)

## PA per batter

get_PA <- function(x){
  app <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, pitch_number == 1)
  PA <- nrow(app)
  return(PA)
}

PA <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, get_PA)

  return(x)
}

mat_pa <- PA(batter)

## HR per pitcher (for FIP)

get_HR <- function(x){
  run <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, events == 2)
  HR <- nrow(run)
  return(HR)
}

HR <- function(pitcher){
  run <- unique(statcast_2017_2018$pitcher)
  x <- lapply(run, get_HR)

  return(x)
}

mat_hr <- HR(pitcher)

## HBP per batter

get_HBP <- function(x){
  hit <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, events == 3)
  HBP <- nrow(hit)
  return(HBP)
}

HBP <- function(batter){
  batter <- unique(statcast_2017_2018$batter)
  x <- lapply(batter, get_HBP)

  return(x)
}

mat_hbp <- HBP(batter)

## HBP per pitcher

get_HBP <- function(x){
  hit <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, events == 3)
  HBP <- nrow(hit)
  return(HBP)
}

HBP <- function(pitcher){
  pitcher <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitcher, get_HBP)

  return(x)
}

mat_hbp_pit <- HBP(pitcher)

## Walks per batter

get_BB_bat <- function(x){
  walk <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, events == 4)
  BB <- nrow(walk)
  return(BB)
}

BB_bat <- function(batter){
  batter <- unique(statcast_2017_2018$batter)
  x <- lapply(batter, get_BB_bat)

  return(x)
}

mat_bb_bat <- BB_bat(batter)

## Walks per pitcher

get_BB_pit <- function(x){
  walk <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, events == 4)
  BB <- nrow(walk)
  return(BB)
}

BB_pit <- function(pitcher){
  pitcher <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitcher, get_BB_pit)

  return(x)
}

mat_bb_pit <- BB_pit(pitcher)

## Strikeout per batter

get_SO_bat <- function(x){
  K <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, events == 5)
  SO <- nrow(K)
  return(SO)
}

SO_bat <- function(batter){
  batter <- unique(statcast_2017_2018$batter)
  x <- lapply(batter, get_SO_bat)

  return(x)
}

mat_so_bat <- SO_bat(batter)

## Strikeouts per pitcher

get_SO_pit <- function(x){
  K <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, events == 5)
  SO <- nrow(K)
  return(SO)
}

SO_pit <- function(pitcher){
  pitcher <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitcher, get_SO_pit)

  return(x)
}

mat_so_pit <- SO_pit(pitcher)

## IP for a given pitcher

get_IP <- function(x){
  innings <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, pitch_number == 1)
  IP <- nrow(innings)/3
  return(IP)
}

IP <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_IP)

  return(x)
}

mat_ip <- IP(pitcher)

## Swings per batter

get_swings_bat <- function(x){
  swing <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, description == 1 | description == 2 | description == 3)
  swings <- nrow(swing)
  return(swings)
}

swings_bat <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, get_swings_bat)

  return(x)
}

mat_swings_bat <- swings_bat(batter)

## Swings per pitcher

get_swings_pit <- function(x){
  swing <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, description == 1 | description == 2 | description == 3)
  swings <- nrow(swing)
  return(swings)
}

swings_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_swings_pit)

  return(x)
}

mat_swings_pit <- swings_pit(pitcher)

## Whiffs per batter

get_whiffs_bat <- function(x){
  whiff <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", batter == x, description == 2)
  whiffs <- nrow(whiff)
  return(whiffs)
}

whiffs_bat <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, get_whiffs_bat)

  return(x)
}

mat_whiffs_bat <- whiffs_bat(batter)

## Whiffs per pitcher

get_whiffs_pit <- function(x){
  whiff <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, description == 2)
  whiffs <- nrow(whiff)
  return(whiffs)
}

whiffs_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_whiffs_pit)

  return(x)
}

mat_whiffs_pit <- whiffs_pit(pitcher)

## Batters faced by pitcher

get_bf_pit <- function(x){
  batters <- filter(statcast_2008_2018, game_date >= "2017-04-02", game_date <= "2018-10-01", pitcher == x, pitch_number == 1)
  faced <- nrow(batters)
  return(faced)
}

bf_pit <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, get_bf_pit)

  return(x)
}

mat_bf_pit <- bf_pit(pitcher)

biseason_bat_stats <- data.frame(batter=unlist(batters), Biseason_bat_H=unlist(mat_hits_bat), Biseason_bat_G=unlist(mat_g_bat), Biseason_bat_PA=unlist(mat_pa), Biseason_bat_HBP=unlist(mat_hbp), Biseason_bat_BB=unlist(mat_bb_bat), Biseason_bat_K=unlist(mat_so_bat), Biseason_bat_Swings=unlist(mat_swings_bat), Biseason_bat_Whiffs=unlist(mat_whiffs_bat))


biseason_pit_stats <- data.frame(pitcher=unlist(pitchers), Biseason_pit_Whiffs=unlist(mat_whiffs_pit), Biseason_pit_Swings=unlist(mat_swings_pit), Biseason_pit_IP=unlist(mat_ip), Biseason_pit_K=unlist(mat_so_pit), Biseason_pit_BB=unlist(mat_bb_pit), Biseason_pit_HR=unlist(mat_hr), Biseason_pit_G=unlist(mat_g_pit), Biseason_pit_H=unlist(mat_hits_pit), Biseason_pit_BF=unlist(mat_bf_pit), Biseason_pit_HBP=unlist(mat_hbp_pit))


## Merge hitting stats back into statcast_2017_2018

statcast_2017_2018 <- merge(statcast_2017_2018, car_bat_stats, by="batter")
statcast_2017_2018 <- merge(statcast_2017_2018, car_pit_stats, by = "pitcher")
statcast_2017_2018 <- merge(statcast_2017_2018, biseason_bat_stats, by="batter")
statcast_2017_2018 <- merge(statcast_2017_2018, biseason_pit_stats, by="pitcher")
write.csv(statcast_2017_2018, "Statcast_2017_2018.csv")
statcast_2017_2018 <- read_csv("Statcast_2017_2018.csv")

league_stats <- read_csv("League_wOBA_1871_2018.csv")



## Batter (career)
car_bat_h_per_game <- (car_bat_stats$Car_bat_H)/(car_bat_stats$Car_bat_G)
car_bat_hits <- car_bat_stats$Car_bat_H 
car_bat_avg_pa <- (car_bat_stats$Car_bat_PA)/(car_bat_stats$Car_bat_G)
car_bat_ba <- (car_bat_stats$Car_bat_H)/(car_bat_stats$Car_bat_PA)

## Pitch proportions per zone

## Zone 1
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone1 <- unlist(car_bat_pitch_prop_zone1(batter))

## Zone 2
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone2 <- unlist(car_bat_pitch_prop_zone2(batter))

## Zone 3
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone3 <- unlist(car_bat_pitch_prop_zone3(batter))

## Zone 4
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone4 <- unlist(car_bat_pitch_prop_zone4(batter))

## Zone 5
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone5 <- unlist(car_bat_pitch_prop_zone5(batter))

## Zone 6
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone6 <- unlist(car_bat_pitch_prop_zone6(batter))

## Zone 7
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone7 <- unlist(car_bat_pitch_prop_zone7(batter))

## Zone 8
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone8 <- unlist(car_bat_pitch_prop_zone8(batter))

## Zone 9
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone9 <- unlist(car_bat_pitch_prop_zone9(batter))

## Zone 11
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone11 <- unlist(car_bat_pitch_prop_zone11(batter))

## Zone 12
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone12 <- unlist(car_bat_pitch_prop_zone12(batter))

## Zone 13
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone13 <- unlist(car_bat_pitch_prop_zone13(batter))

## Zone 14
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone14 <- unlist(car_bat_pitch_prop_zone14(batter))

## Zone 16
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}
car_bat_pitch_prop_zone16 <- unlist(car_bat_pitch_prop_zone16(batter))

## Zone 17
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 17)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone17 <- unlist(car_bat_pitch_prop_zone17(batter))

## Zone 18
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 18)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone18 <- unlist(car_bat_pitch_prop_zone18(batter))

## Zone 19
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 19)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone19 <- unlist(car_bat_pitch_prop_zone19(batter))

## Zone 21
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 21)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone21 <- unlist(car_bat_pitch_prop_zone21(batter))

## Zone 22
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 22)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone22 <- unlist(car_bat_pitch_prop_zone22(batter))

## Zone 23
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 23)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone23 <-unlist(car_bat_pitch_prop_zone23(batter))

## Zone 24
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 24)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone24 <- unlist(car_bat_pitch_prop_zone24(batter))

## Zone 26
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 26)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone26 <- unlist(car_bat_pitch_prop_zone26(batter))

## Zone 27
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 27)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone27 <- unlist(car_bat_pitch_prop_zone27(batter))

## Zone 28
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 28)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}
car_bat_pitch_prop_zone28 <- unlist(car_bat_pitch_prop_zone28(batter))

## Zone 29
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 29)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}
car_bat_pitch_prop_zone29 <- unlist(car_bat_pitch_prop_zone29(batter))

## Zone 30
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 30)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_pitch_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

car_bat_pitch_prop_zone30 <- unlist(car_bat_pitch_prop_zone30(batter))

batters <- unlist(unique(statcast_2017_2018$batter))

batter_career1 <- data.frame(batters, car_bat_h_per_game, car_bat_hits, car_bat_avg_pa, car_bat_ba, car_bat_pitch_prop_zone1, car_bat_pitch_prop_zone2, car_bat_pitch_prop_zone3, car_bat_pitch_prop_zone4, car_bat_pitch_prop_zone5, car_bat_pitch_prop_zone6, car_bat_pitch_prop_zone7, car_bat_pitch_prop_zone8, car_bat_pitch_prop_zone9, car_bat_pitch_prop_zone11, car_bat_pitch_prop_zone12, car_bat_pitch_prop_zone13, car_bat_pitch_prop_zone14, car_bat_pitch_prop_zone16, car_bat_pitch_prop_zone17, car_bat_pitch_prop_zone18, car_bat_pitch_prop_zone19, car_bat_pitch_prop_zone21, car_bat_pitch_prop_zone22, car_bat_pitch_prop_zone23, car_bat_pitch_prop_zone24, car_bat_pitch_prop_zone26, car_bat_pitch_prop_zone27, car_bat_pitch_prop_zone28, car_bat_pitch_prop_zone29, car_bat_pitch_prop_zone30)

## Batter (career)
## Swing proportions by zone

## Zone 1
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone1 <- unlist(car_bat_swing_prop_zone1(batter))

## Zone 2
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone2 <- unlist(car_bat_swing_prop_zone2(batter))

## Zone 3
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone3 <- unlist(car_bat_swing_prop_zone3(batter))

## Zone 4
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone4 <- unlist(car_bat_swing_prop_zone4(batter))

## Zone 5
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone5 <- unlist(car_bat_swing_prop_zone5(batter))

## Zone 6
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone6 <- unlist(car_bat_swing_prop_zone6(batter))

## Zone 7
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone7 <- unlist(car_bat_swing_prop_zone7(batter))

## Zone 8
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone8 <- unlist(car_bat_swing_prop_zone8(batter))

## Zone 9
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone9 <- unlist(car_bat_swing_prop_zone9(batter))

## Zone 11
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone11 <- unlist(car_bat_swing_prop_zone11(batter))

## Zone 12
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone12 <- unlist(car_bat_swing_prop_zone12(batter))

## Zone 13
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone13 <- unlist(car_bat_swing_prop_zone13(batter))

## Zone 14
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone14 <- unlist(car_bat_swing_prop_zone14(batter))

## Zone 16
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone16 <- unlist(car_bat_swing_prop_zone16(batter))

## Zone 17
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 17)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone17 <- unlist(car_bat_swing_prop_zone17(batter))

## Zone 18
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 18)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone18 <- unlist(car_bat_swing_prop_zone18(batter))

## Zone 19
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 19)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone19 <- unlist(car_bat_swing_prop_zone19(batter))

## Zone 21
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 21)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}
car_bat_swing_prop_zone21 <- unlist(car_bat_swing_prop_zone21(batter))

## Zone 22
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 22)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone22 <- unlist(car_bat_swing_prop_zone22(batter))

## Zone 23
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 23)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone23 <- unlist(car_bat_swing_prop_zone23(batter))

## Zone 24
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 24)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}
car_bat_swing_prop_zone24 <- unlist(car_bat_swing_prop_zone24(batter))

## Zone 26
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 26)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone26 <- unlist(car_bat_swing_prop_zone26(batter))

## Zone 27
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 27)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone27 <- unlist(car_bat_swing_prop_zone27(batter))

## Zone 28
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 28)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}
car_bat_swing_prop_zone28 <- unlist(car_bat_swing_prop_zone28(batter))

## Zone 29
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 29)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone29 <- unlist(car_bat_swing_prop_zone29(batter))

## Zone 30
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 30)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_swing_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

car_bat_swing_prop_zone30 <- unlist(car_bat_swing_prop_zone30(batter))

batter_career2 <- data.frame(car_bat_swing_prop_zone1, car_bat_swing_prop_zone2, car_bat_swing_prop_zone3, car_bat_swing_prop_zone4, car_bat_swing_prop_zone5, car_bat_swing_prop_zone6, car_bat_swing_prop_zone7, car_bat_swing_prop_zone8, car_bat_swing_prop_zone9, car_bat_swing_prop_zone11, car_bat_swing_prop_zone12, car_bat_swing_prop_zone13, car_bat_swing_prop_zone14, car_bat_swing_prop_zone16, car_bat_swing_prop_zone17, car_bat_swing_prop_zone18, car_bat_swing_prop_zone19, car_bat_swing_prop_zone21, car_bat_swing_prop_zone22, car_bat_swing_prop_zone23, car_bat_swing_prop_zone24, car_bat_swing_prop_zone26, car_bat_swing_prop_zone27, car_bat_swing_prop_zone28, car_bat_swing_prop_zone29, car_bat_swing_prop_zone30)

## Batter (career)
## Whiff proportion per zone

## Zone 1
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone1 <- unlist(car_bat_whiff_prop_zone1(batter))

## Zone 2
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone2 <- unlist(car_bat_whiff_prop_zone2(batter))

## Zone 3
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone3 <- unlist(car_bat_whiff_prop_zone3(batter))

## Zone 4
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone4 <- unlist(car_bat_whiff_prop_zone4(batter))

## Zone 5
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone5 <- unlist(car_bat_whiff_prop_zone5(batter))

## Zone 6
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone6 <- unlist(car_bat_whiff_prop_zone6(batter))

## Zone 7
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone7 <- unlist(car_bat_whiff_prop_zone7(batter))

## Zone 8
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone8 <- unlist(car_bat_whiff_prop_zone8(batter))

## Zone 9
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone9 <- unlist(car_bat_whiff_prop_zone9(batter))

## Zone 11
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone11 <- unlist(car_bat_whiff_prop_zone11(batter))

## Zone 12
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone12 <- unlist(car_bat_whiff_prop_zone12(batter))

## Zone 13
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone13 <- unlist(car_bat_whiff_prop_zone13(batter))

## Zone 14
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone14 <- unlist(car_bat_whiff_prop_zone14(batter))

## Zone 16
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone16 <- unlist(car_bat_whiff_prop_zone16(batter))

## Zone 17
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 17)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone17 <- unlist(car_bat_whiff_prop_zone17(batter))

## Zone 18
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 18)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone18 <- unlist(car_bat_whiff_prop_zone18(batter))

## Zone 19
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 19)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}
car_bat_whiff_prop_zone19 <- unlist(car_bat_whiff_prop_zone19(batter))

## Zone 21
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 21)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone21 <- unlist(car_bat_whiff_prop_zone21(batter))

## Zone 22
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 22)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone22 <- unlist(car_bat_whiff_prop_zone22(batter))

## Zone 23
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 23)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone23 <- unlist(car_bat_whiff_prop_zone23(batter))

## Zone 24
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 24)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone24 <- unlist(car_bat_whiff_prop_zone24(batter))

## Zone 26
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 26)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone26 <- unlist(car_bat_whiff_prop_zone26(batter))

## Zone 27
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 27)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone27 <- unlist(car_bat_whiff_prop_zone27(batter))

## Zone 28
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 28)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone28 <- unlist(car_bat_whiff_prop_zone28(batter))

## Zone 29
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 29)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone29 <- unlist(car_bat_whiff_prop_zone29(batter))

## Zone 30
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 30)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_whiff_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

car_bat_whiff_prop_zone30 <- unlist(car_bat_whiff_prop_zone30(batter))

batter_career3 <- data.frame(car_bat_whiff_prop_zone1, car_bat_whiff_prop_zone2, car_bat_whiff_prop_zone3, car_bat_whiff_prop_zone4, car_bat_whiff_prop_zone5, car_bat_whiff_prop_zone6, car_bat_whiff_prop_zone7, car_bat_whiff_prop_zone8, car_bat_whiff_prop_zone9, car_bat_whiff_prop_zone11, car_bat_whiff_prop_zone12, car_bat_whiff_prop_zone13, car_bat_whiff_prop_zone14, car_bat_whiff_prop_zone16, car_bat_whiff_prop_zone17, car_bat_whiff_prop_zone18, car_bat_whiff_prop_zone19, car_bat_whiff_prop_zone21, car_bat_whiff_prop_zone22, car_bat_whiff_prop_zone23, car_bat_whiff_prop_zone24, car_bat_whiff_prop_zone26, car_bat_whiff_prop_zone27, car_bat_whiff_prop_zone28, car_bat_whiff_prop_zone29, car_bat_whiff_prop_zone30)

## Batter (career)
## K+BB proportion per zone

## Zone 1
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 1)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 1)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone1 <- unlist(car_bat_k_bb_prop_zone1(batter))

## Zone 2
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 2)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 2)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone2 <- unlist(car_bat_k_bb_prop_zone2(batter))

## Zone 3
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 3)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 3)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone3 <- unlist(car_bat_k_bb_prop_zone3(batter))

## Zone 4
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 4)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 4)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone4 <- unlist(car_bat_k_bb_prop_zone4(batter))

## Zone 5
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 5)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 5)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone5 <- unlist(car_bat_k_bb_prop_zone5(batter))

## Zone 6
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 6)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 6)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone6 <- unlist(car_bat_k_bb_prop_zone6(batter))

## Zone 7
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 7)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 7)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone7 <- unlist(car_bat_k_bb_prop_zone7(batter))

## Zone 8
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 8)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 8)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone8 <- unlist(car_bat_k_bb_prop_zone8(batter))

## Zone 9
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 9)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 9)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone9 <- unlist(car_bat_k_bb_prop_zone9(batter))

## Zone 11
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 11)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 11)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone11 <- unlist(car_bat_k_bb_prop_zone11(batter))

## Zone 12
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 12)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 12)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone12 <- unlist(car_bat_k_bb_prop_zone12(batter))

## Zone 13
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 13)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 13)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone13 <- unlist(car_bat_k_bb_prop_zone13(batter))

## Zone 14
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 14)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 14)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone14 <- unlist(car_bat_k_bb_prop_zone14(batter))

## Zone 16
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 16)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 16)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone16 <- unlist(car_bat_k_bb_prop_zone16(batter))

## Zone 17
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 17)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 17)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone17 <- unlist(car_bat_k_bb_prop_zone17(batter))

## Zone 18
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 18)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 18)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone18 <- unlist(car_bat_k_bb_prop_zone18(batter))
```

```{r}
## Zone 19
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 19)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 19)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone19 <- unlist(car_bat_k_bb_prop_zone19(batter))

## Zone 21
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 21)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 21)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone21 <- unlist(car_bat_k_bb_prop_zone21(batter))

## Zone 22
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 22)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 22)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone22 <- unlist(car_bat_k_bb_prop_zone22(batter))

## Zone 23
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 23)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 23)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone23 <- unlist(car_bat_k_bb_prop_zone23(batter))

## Zone 24
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 24)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 24)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone24 <- unlist(car_bat_k_bb_prop_zone24(batter))

## Zone 26
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 26)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 26)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone26 <- unlist(car_bat_k_bb_prop_zone26(batter))

## Zone 27
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 27)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 27)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone27 <- unlist(car_bat_k_bb_prop_zone27(batter))

## Zone 28
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 28)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 28)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone28 <- unlist(car_bat_k_bb_prop_zone28(batter))

## Zone 29
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 29)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 29)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

car_bat_k_bb_prop_zone29 <- unlist(car_bat_k_bb_prop_zone29(batter))

## Zone 30
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 30)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 30)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_k_bb_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}


car_bat_k_bb_prop_zone30 <- unlist(car_bat_k_bb_prop_zone30(batter))

batter_career4 <- data.frame(car_bat_k_bb_prop_zone1, car_bat_k_bb_prop_zone2, car_bat_k_bb_prop_zone3, car_bat_k_bb_prop_zone4, car_bat_k_bb_prop_zone5, car_bat_k_bb_prop_zone6, car_bat_k_bb_prop_zone7, car_bat_k_bb_prop_zone8, car_bat_k_bb_prop_zone9, car_bat_k_bb_prop_zone11, car_bat_k_bb_prop_zone12, car_bat_k_bb_prop_zone13, car_bat_k_bb_prop_zone14, car_bat_k_bb_prop_zone16, car_bat_k_bb_prop_zone17, car_bat_k_bb_prop_zone18, car_bat_k_bb_prop_zone19, car_bat_k_bb_prop_zone21, car_bat_k_bb_prop_zone22, car_bat_k_bb_prop_zone23, car_bat_k_bb_prop_zone24, car_bat_k_bb_prop_zone26, car_bat_k_bb_prop_zone27, car_bat_k_bb_prop_zone28, car_bat_k_bb_prop_zone29, car_bat_k_bb_prop_zone30)
```

```{r}
## Batter (career)
## Hit proportion per pitch type

## Pitch 0
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 0)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch0 <- unlist(car_bat_hit_prop_pitch1(batter))

## Pitch 1
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch1 <- unlist(car_bat_hit_prop_pitch1(batter))

## Pitch 2
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch2 <- unlist(car_bat_hit_prop_pitch2(batter))

## Pitch 3
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch3 <- unlist(car_bat_hit_prop_pitch3(batter))

## Pitch 4
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch4 <- unlist(car_bat_hit_prop_pitch4(batter))

## Pitch 5
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch5 <- unlist(car_bat_hit_prop_pitch5(batter))

## Pitch 6
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch6 <- unlist(car_bat_hit_prop_pitch6(batter))

## Pitch 7
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch7 <- unlist(car_bat_hit_prop_pitch7(batter))

## Pitch 8
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch8 <- unlist(car_bat_hit_prop_pitch8(batter))

## Pitch 9
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch9 <- unlist(car_bat_hit_prop_pitch9(batter))

## Pitch 10
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 10)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch10 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}
car_bat_hit_prop_pitch10 <- unlist(car_bat_hit_prop_pitch10(batter))

## Pitch 11
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch11 <- unlist(car_bat_hit_prop_pitch11(batter))

## Pitch 12
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch12 <- unlist(car_bat_hit_prop_pitch12(batter))

## Pitch 13
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}
car_bat_hit_prop_pitch13 <- unlist(car_bat_hit_prop_pitch13(batter))

## Pitch 14
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch14 <- unlist(car_bat_hit_prop_pitch14(batter))

## Pitch 15
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 15)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch15 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch15 <- unlist(car_bat_hit_prop_pitch15(batter))

## Pitch 16
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_hit_prop_pitch16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

car_bat_hit_prop_pitch16 <- unlist(car_bat_hit_prop_pitch16(batter))
```

```{r}
batter_career5 <- data.frame(car_bat_hit_prop_pitch0, car_bat_hit_prop_pitch1, car_bat_hit_prop_pitch2, car_bat_hit_prop_pitch3, car_bat_hit_prop_pitch4, car_bat_hit_prop_pitch5, car_bat_hit_prop_pitch6, car_bat_hit_prop_pitch7, car_bat_hit_prop_pitch8, car_bat_hit_prop_pitch9, car_bat_hit_prop_pitch10, car_bat_hit_prop_pitch11, car_bat_hit_prop_pitch12, car_bat_hit_prop_pitch13, car_bat_hit_prop_pitch14, car_bat_hit_prop_pitch15, car_bat_hit_prop_pitch16)


## Batter (career)
## No hits per pitch type

## Pitch 0
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 0)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch0 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch0 <- unlist(car_bat_nohit_prop_pitch0(batter))

## Pitch 1
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch1 <- unlist(car_bat_nohit_prop_pitch1(batter))

## Pitch 2
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch2 <- unlist(car_bat_nohit_prop_pitch2(batter))

## Pitch 3
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch3 <- unlist(car_bat_nohit_prop_pitch3(batter))

## Pitch 4
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch4 <- unlist(car_bat_nohit_prop_pitch4(batter))

## Pitch 5
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch5 <- unlist(car_bat_nohit_prop_pitch5(batter))

## Pitch 6
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch6 <- unlist(car_bat_nohit_prop_pitch6(batter))

## Pitch 7
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch7 <- unlist(car_bat_nohit_prop_pitch7(batter))

## Pitch 8
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch8 <- unlist(car_bat_nohit_prop_pitch8(batter))

## Pitch 9
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch9 <- unlist(car_bat_nohit_prop_pitch9(batter))

## Pitch 10
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 10)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch10 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch10 <- unlist(car_bat_nohit_prop_pitch10(batter))

## Pitch 11
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch11 <- unlist(car_bat_nohit_prop_pitch11(batter))

## Pitch 12
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch12 <- unlist(car_bat_nohit_prop_pitch12(batter))

## Pitch 13
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch13 <- unlist(car_bat_nohit_prop_pitch13(batter))

## Pitch 14
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch14 <- unlist(car_bat_nohit_prop_pitch14(batter))

## Pitch 15
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 15)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch15 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch15 <- unlist(car_bat_nohit_prop_pitch15(batter))

## Pitch 16
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
car_bat_nohit_prop_pitch16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

car_bat_nohit_prop_pitch16 <- unlist(car_bat_nohit_prop_pitch16(batter))

batter_career6 <- data.frame(car_bat_nohit_prop_pitch0, car_bat_nohit_prop_pitch1, car_bat_nohit_prop_pitch2, car_bat_nohit_prop_pitch3, car_bat_nohit_prop_pitch4, car_bat_nohit_prop_pitch5, car_bat_nohit_prop_pitch6, car_bat_nohit_prop_pitch7, car_bat_nohit_prop_pitch8, car_bat_nohit_prop_pitch9, car_bat_nohit_prop_pitch10, car_bat_nohit_prop_pitch11, car_bat_nohit_prop_pitch12, car_bat_nohit_prop_pitch13, car_bat_nohit_prop_pitch14, car_bat_nohit_prop_pitch15, car_bat_nohit_prop_pitch16)
```

```{r eval=FALSE, include=FALSE}
## Batter (career)
## BA by zone (hits per zone divided by total pa)

## Zone 1
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 1)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone1 <- unlist(car_bat_ba_prop_zone1(batter))

## Zone 2
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 2)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone2 <- unlist(car_bat_ba_prop_zone2(batter))

## Zone 3
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 3)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone3 <- unlist(car_bat_ba_prop_zone3(batter))

## Zone 4
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 4)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone4 <- unlist(car_bat_ba_prop_zone4(batter))

## Zone 5
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 5)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone5 <- unlist(car_bat_ba_prop_zone5(batter))

## Zone 6
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 6)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone6 <- unlist(car_bat_ba_prop_zone6(batter))

## Zone 7
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 7)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone7 <- unlist(car_bat_ba_prop_zone7(batter))

## Zone 8
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 8)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone8 <- unlist(car_bat_ba_prop_zone8(batter))

## Zone 9
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 9)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone9 <- unlist(car_bat_ba_prop_zone9(batter))

## Zone 11
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 11)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone11 <- unlist(car_bat_ba_prop_zone11(batter))

## Zone 12
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 12)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone12 <- unlist(car_bat_ba_prop_zone12(batter))

## Zone 13
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 13)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone13 <- unlist(car_bat_ba_prop_zone13(batter))

## Zone 14
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 14)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone14 <- unlist(car_bat_ba_prop_zone14(batter))

## Zone 16
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 16)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone16 <- unlist(car_bat_ba_prop_zone16(batter))

## Zone 17
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 17)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone17 <- unlist(car_bat_ba_prop_zone17(batter))

## Zone 18
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 18)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone18 <- unlist(car_bat_ba_prop_zone18(batter))

## Zone 19
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 19)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone19 <- unlist(car_bat_ba_prop_zone19(batter))

## Zone 21
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 21)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone21 <- unlist(car_bat_ba_prop_zone21(batter))

## Zone 22
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 22)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone22 <- unlist(car_bat_ba_prop_zone22(batter))

## Zone 23
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 23)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone23 <- unlist(car_bat_ba_prop_zone23(batter))

## Zone 24
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 24)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone24 <- unlist(car_bat_ba_prop_zone24(batter))

## Zone 26
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 26)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone26 <- unlist(car_bat_ba_prop_zone26(batter))

## Zone 27
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 27)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone27 <- unlist(car_bat_ba_prop_zone27(batter))

## Zone 28
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 28)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

car_bat_ba_prop_zone28 <- unlist(car_bat_ba_prop_zone28(batter))

## Zone 29
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 29)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone29 <- unlist(car_bat_ba_prop_zone29(batter))

## Zone 30
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 30)
  zone <- nrow(batters)
  prop <- zone/((car_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
car_bat_ba_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
car_bat_ba_prop_zone30 <- unlist(car_bat_ba_prop_zone30(batter))

batter_career7 <- data.frame(car_bat_ba_prop_zone1, car_bat_ba_prop_zone2, car_bat_ba_prop_zone3, car_bat_ba_prop_zone4, car_bat_ba_prop_zone5, car_bat_ba_prop_zone6, car_bat_ba_prop_zone7, car_bat_ba_prop_zone8, car_bat_ba_prop_zone9, car_bat_ba_prop_zone11, car_bat_ba_prop_zone12, car_bat_ba_prop_zone13, car_bat_ba_prop_zone14, car_bat_ba_prop_zone16, car_bat_ba_prop_zone17, car_bat_ba_prop_zone18, car_bat_ba_prop_zone19, car_bat_ba_prop_zone21, car_bat_ba_prop_zone22, car_bat_ba_prop_zone23, car_bat_ba_prop_zone24, car_bat_ba_prop_zone26, car_bat_ba_prop_zone27, car_bat_ba_prop_zone28, car_bat_ba_prop_zone29, car_bat_ba_prop_zone30)

## Dataframe of batter career stats
batter_career <- bind_cols(batter_career1, batter_career2, batter_career3, batter_career4, batter_career5, batter_career6, batter_career7)

colnames(batter_career)[colnames(batter_career) == "batters"] <- "batter"
```

```{r}
## Pitcher (career)

car_pit_FIP <- (13*(car_pit_stats$Car_pit_HR)+3*(car_pit_stats$Car_pit_BB)-2*(car_pit_stats$Car_pit_K))/(car_pit_stats$Car_pit_IP) + ((league_stats$cFIP[1]+league_stats$cFIP[2]+league_stats$cFIP[3]+league_stats$cFIP[4]+league_stats$cFIP[5]+league_stats$cFIP[6]+league_stats$cFIP[7]+league_stats$cFIP[8]+league_stats$cFIP[9]+league_stats$cFIP[10]+league_stats$cFIP[11])/11)
car_pit_h9 <- ((car_pit_stats$Car_pit_H)*9)/(car_pit_stats$Car_pit_IP)
car_pit_noh9 <- ((car_pit_stats$Car_pit_K + car_pit_stats$Car_pit_BB)*9)/(car_pit_stats$Car_pit_IP)
car_pit_k_bb <- (car_pit_stats$Car_pit_K)/(car_pit_stats$Car_pit_BB)
car_pit_hits <- car_pit_stats$Car_pit_H
car_pit_avg_ip <- (car_pit_stats$Car_pit_IP)/(car_pit_stats$Car_pit_G)
car_pit_ba <- (car_pit_stats$Car_pit_H)/((car_pit_stats$Car_pit_BF))

pitcher_career1 <- data.frame(unlist(car_pit_FIP), unlist(car_pit_h9), unlist(car_pit_noh9), unlist(car_pit_k_bb), unlist(car_pit_hits), unlist(car_pit_avg_ip), unlist(car_pit_ba))
```

```{r}
## Pitcher (career)
## BA by zone (hits per zone divided by total pa)

## Zone 1
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 1)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone1 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 2
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 2)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone2 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 3
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 3)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone3 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 4
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 4)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone4 <- unlist(car_pit_ba_prop_zone1(batter))

## Zone 5
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 5)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone5 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 6
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 6)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone6 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 7
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 7)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone7 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 8
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 8)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone8 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 9
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 9)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone9 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 11
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 11)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone11 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 12
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 12)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone12 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 13
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 13)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone13 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 14
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 14)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone14 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 16
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 16)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone16 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 17
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 17)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone17 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 18
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 18)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone18 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 19
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 19)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone19 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 21
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 21)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone21 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 22
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 22)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone22 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 23
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 23)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone23 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 24
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 24)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone24 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 26
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 26)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone26 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 27
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 27)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone27 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 28
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 28)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone28 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 29
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 29)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone29 <- unlist(car_pit_ba_prop_zone1(pitcher))

## Zone 30
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 30)
  zone <- nrow(pitchers)
  prop <- zone/((car_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
car_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
car_pit_ba_prop_zone30 <- unlist(car_pit_ba_prop_zone1(pitcher))

pitchers <- unlist(unique(statcast_2017_2018$pitcher))

pitcher_career2 <- data.frame(car_pit_ba_prop_zone1, car_pit_ba_prop_zone2, car_pit_ba_prop_zone3, car_pit_ba_prop_zone4, car_pit_ba_prop_zone5, car_pit_ba_prop_zone6, car_pit_ba_prop_zone7, car_pit_ba_prop_zone8, car_pit_ba_prop_zone9, car_pit_ba_prop_zone11, car_pit_ba_prop_zone12, car_pit_ba_prop_zone13, car_pit_ba_prop_zone14, car_pit_ba_prop_zone16, car_pit_ba_prop_zone17, car_pit_ba_prop_zone18, car_pit_ba_prop_zone19, car_pit_ba_prop_zone21, car_pit_ba_prop_zone22, car_pit_ba_prop_zone23, car_pit_ba_prop_zone24, car_pit_ba_prop_zone26, car_pit_ba_prop_zone27, car_pit_ba_prop_zone28, car_pit_ba_prop_zone29, car_pit_ba_prop_zone30)
```

```{r}
## Pitcher (career)
## Pitch proportions by zone

## Zone 1
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 1)
  zones <- nrow(pitchers)
  prop <- zones/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone1 <- unlist(car_pit_pitches_prop_zone1(pitcher))
```

```{r}
## Zone 2
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone2 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 3
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone3 <- unlist(car_pit_pitches_prop_zone1(pitcher))
```

```{r}
## Zone 4
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone4 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 5
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone5 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 6
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone6 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 7
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone7 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 8
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone8 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 9
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone9 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 11
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone11 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 12
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone12 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 13
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone13 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 14
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone14 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 16
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit__pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone16 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 17
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone17 <- unlist(car_pit_pitches_prop_zone1(pitcher))
## Zone 18
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone18 <- unlist(car_pit_pitches_prop_zone1(pitcher))
## Zone 19
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone19 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 21
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone21 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 22
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone22 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 23
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone23 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 24
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone24 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 26
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone26 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 27
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone27 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 28
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone28 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 29
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone29 <- unlist(car_pit_pitches_prop_zone1(pitcher))

## Zone 30
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
car_pit_pitches_prop_zone30 <- unlist(car_pit_pitches_prop_zone1(pitcher))

pitcher_career3 <- data.frame(car_pit_pitches_prop_zone1, car_pit_pitches_prop_zone2, car_pit_pitches_prop_zone3, car_pit_pitches_prop_zone4, car_pit_pitches_prop_zone5, car_pit_pitches_prop_zone6, car_pit_pitches_prop_zone7, car_pit_pitches_prop_zone8, car_pit_pitches_prop_zone9, car_pit_pitches_prop_zone11, car_pit_pitches_prop_zone12, car_pit_pitches_prop_zone13, car_pit_pitches_prop_zone14, car_pit_pitches_prop_zone16, car_pit_pitches_prop_zone17, car_pit_pitches_prop_zone18, car_pit_pitches_prop_zone19, car_pit_pitches_prop_zone21, car_pit_pitches_prop_zone22, car_pit_pitches_prop_zone23, car_pit_pitches_prop_zone24, car_pit_pitches_prop_zone26, car_pit_pitches_prop_zone27, car_pit_pitches_prop_zone28, car_pit_pitches_prop_zone29, car_pit_pitches_prop_zone30)
```

```{r}
## Pitcher (career)
## Swing proportion by zone

## Zone 1
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone1 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 2
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone2 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 3
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone3 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 4
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone4 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 5
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone5 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 6
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone6 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 7
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone7 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 8
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone8 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 9
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone9 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 11
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone11 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 12
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone12 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 13
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone13 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 14
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone14 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 16
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit__swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone16 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 17
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone17 <- unlist(car_pit_swings_prop_zone1(pitcher))
## Zone 18
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone18 <- unlist(car_pit_swings_prop_zone1(pitcher))
## Zone 19
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone19 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 21
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone21 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 22
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone22 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 23
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone23 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 24
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone24 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 26
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone26 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 27
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone27 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 28
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone28 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 29
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone29 <- unlist(car_pit_swings_prop_zone1(pitcher))

## Zone 30
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
car_pit_swings_prop_zone30 <- unlist(car_pit_swings_prop_zone1(pitcher))

pitcher_career4 <- data.frame(car_pit_swings_prop_zone1, car_pit_swings_prop_zone2, car_pit_swings_prop_zone3, car_pit_swings_prop_zone4, car_pit_swings_prop_zone5, car_pit_swings_prop_zone6, car_pit_swings_prop_zone7, car_pit_swings_prop_zone8, car_pit_swings_prop_zone9, car_pit_swings_prop_zone11, car_pit_swings_prop_zone12, car_pit_swings_prop_zone13, car_pit_swings_prop_zone14, car_pit_swings_prop_zone16, car_pit_swings_prop_zone17, car_pit_swings_prop_zone18, car_pit_swings_prop_zone19, car_pit_swings_prop_zone21, car_pit_swings_prop_zone22, car_pit_swings_prop_zone23, car_pit_swings_prop_zone24, car_pit_swings_prop_zone26, car_pit_swings_prop_zone27, car_pit_swings_prop_zone28, car_pit_swings_prop_zone29, car_pit_swings_prop_zone30)
```

```{r}
## Pitcher (career)
## Whiffs proportion per zone

## Zone 1
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone1 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 2
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone2 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 3
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone3 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 4
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone4 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 5
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone5 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 6
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone6 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 7
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone7 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 8
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone8 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 9
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone9 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 11
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone11 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 12
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone12 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 13
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone13 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 14
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone14 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 16
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit__whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone16 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 17
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone17 <- unlist(car_pit_whiffs_prop_zone1(pitcher))
## Zone 18
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone18 <- unlist(car_pit_whiffs_prop_zone1(pitcher))
## Zone 19
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone19 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 21
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone21 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 22
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone22 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 23
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone23 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 24
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone24 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 26
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone26 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 27
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone27 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 28
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone28 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 29
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone29 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

## Zone 30
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
car_pit_whiffs_prop_zone30 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

car_pit_whiffs_prop_zone1 <- unlist(car_pit_whiffs_prop_zone1(pitcher))

pitcher_career5 <- data.frame(car_pit_whiffs_prop_zone1, car_pit_whiffs_prop_zone2, car_pit_whiffs_prop_zone3, car_pit_whiffs_prop_zone4, car_pit_whiffs_prop_zone5, car_pit_whiffs_prop_zone6, car_pit_whiffs_prop_zone7, car_pit_whiffs_prop_zone8, car_pit_whiffs_prop_zone9, car_pit_whiffs_prop_zone11, car_pit_whiffs_prop_zone12, car_pit_whiffs_prop_zone13, car_pit_whiffs_prop_zone14, car_pit_whiffs_prop_zone16, car_pit_whiffs_prop_zone17, car_pit_whiffs_prop_zone18, car_pit_whiffs_prop_zone19, car_pit_whiffs_prop_zone21, car_pit_whiffs_prop_zone22, car_pit_whiffs_prop_zone23, car_pit_whiffs_prop_zone24, car_pit_whiffs_prop_zone26, car_pit_whiffs_prop_zone27, car_pit_whiffs_prop_zone28, car_pit_whiffs_prop_zone29, car_pit_whiffs_prop_zone30)

## Pitcher (career)
## Hit proportion by zone

## Zone 1
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone1 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 2
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone2 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 3
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone3 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 4
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone4 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 5
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone5 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 6
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone6 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 7
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone7 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 8
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone8 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 9
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone9 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 11
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone11 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 12
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone12 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 13
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone13 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 14
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone14 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 16
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit__hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone16 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 17
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone17 <- unlist(car_pit_hits_prop_zone1(pitcher))
## Zone 18
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone18 <- unlist(car_pit_hits_prop_zone1(pitcher))
## Zone 19
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone19 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 21
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone21 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 22
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone22 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 23
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone23 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 24
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone24 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 26
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone26 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 27
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone27 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 28
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone28 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 29
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone29 <- unlist(car_pit_hits_prop_zone1(pitcher))

## Zone 30
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
car_pit_hits_prop_zone30 <- unlist(car_pit_hits_prop_zone1(pitcher))
car_pit_hits_prop_zone1 <- unlist(car_pit_hits_prop_zone1(pitcher))

pitcher_career6 <- data.frame(car_pit_hits_prop_zone1, car_pit_hits_prop_zone2, car_pit_hits_prop_zone3, car_pit_hits_prop_zone4, car_pit_hits_prop_zone5, car_pit_hits_prop_zone6, car_pit_hits_prop_zone7, car_pit_hits_prop_zone8, car_pit_hits_prop_zone9, car_pit_hits_prop_zone11, car_pit_hits_prop_zone12, car_pit_hits_prop_zone13, car_pit_hits_prop_zone14, car_pit_hits_prop_zone16, car_pit_hits_prop_zone17, car_pit_hits_prop_zone18, car_pit_hits_prop_zone19, car_pit_hits_prop_zone21, car_pit_hits_prop_zone22, car_pit_hits_prop_zone23, car_pit_hits_prop_zone24, car_pit_hits_prop_zone26, car_pit_hits_prop_zone27, car_pit_hits_prop_zone28, car_pit_hits_prop_zone29, car_pit_hits_prop_zone30)

## Pitcher (career)
## No hit (K+BB) proportion by zone

## Zone 1
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone1 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 2
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone2 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 3
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone3 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 4
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone4 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 5
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone5 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 6
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone6 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 7
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone7 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 8
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone8 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 9
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone9 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 11
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone11 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 12
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone12 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 13
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone13 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 14
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone14 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 16
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit__nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone16 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 17
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone17 <- unlist(car_pit_nohits_prop_zone1(pitcher))
## Zone 18
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone18 <- unlist(car_pit_nohits_prop_zone1(pitcher))
## Zone 19
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone19 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 21
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone21 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 22
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone22 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 23
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone23 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 24
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone24 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 26
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone26 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 27
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone27 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 28
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone28 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 29
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone29 <- unlist(car_pit_nohits_prop_zone1(pitcher))

## Zone 30
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
car_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
car_pit_nohits_prop_zone30 <- unlist(car_pit_nohits_prop_zone1(pitcher))

car_pit_nohits_prop_zone1 <- unlist(car_pit_nohits_prop_zone1(pitcher))

pitcher <- unique(statcast_2017_2018$pitcher)

pitcher_career7 <- data.frame(pitcher, car_pit_nohits_prop_zone1, car_pit_nohits_prop_zone2, car_pit_nohits_prop_zone3, car_pit_nohits_prop_zone4, car_pit_nohits_prop_zone5, car_pit_nohits_prop_zone6, car_pit_nohits_prop_zone7, car_pit_nohits_prop_zone8, car_pit_nohits_prop_zone9, car_pit_nohits_prop_zone11, car_pit_nohits_prop_zone12, car_pit_nohits_prop_zone13, car_pit_nohits_prop_zone14, car_pit_nohits_prop_zone16, car_pit_nohits_prop_zone17, car_pit_nohits_prop_zone18, car_pit_nohits_prop_zone19, car_pit_nohits_prop_zone21, car_pit_nohits_prop_zone22, car_pit_nohits_prop_zone23, car_pit_nohits_prop_zone24, car_pit_nohits_prop_zone26, car_pit_nohits_prop_zone27, car_pit_nohits_prop_zone28, car_pit_nohits_prop_zone29, car_pit_nohits_prop_zone30)

pitcher_career <- bind_cols(pitcher_career1, pitcher_career2, pitcher_career3, pitcher_career4, pitcher_career5, pitcher_career6, pitcher_career7)

######################

## Batter (2017-2018)
biseason_bat_h_per_avg_pa <- ((biseason_bat_stats$Biseason_bat_H)*(biseason_bat_stats$Biseason_bat_G))/(biseason_bat_stats$Biseason_bat_PA)
biseason_bat_hits <- biseason_bat_stats$Biseason_bat_H 
biseason_bat_avg_pa <- (biseason_bat_stats$Biseason_bat_PA)/(biseason_bat_stats$Biseason_bat_G)
biseason_bat_ba <- (biseason_bat_stats$Biseason_bat_H)/(biseason_bat_stats$Biseason_bat_PA)


## Pitch proportions per zone

## Zone 1
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone1 <- unlist(bi_bat_pitch_prop_zone1(batter))

## Zone 2
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone2 <- unlist(bi_bat_pitch_prop_zone2(batter))

## Zone 3
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone3 <- unlist(bi_bat_pitch_prop_zone3(batter))

## Zone 4
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone4 <- unlist(bi_bat_pitch_prop_zone4(batter))

## Zone 5
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone5 <- unlist(bi_bat_pitch_prop_zone5(batter))

## Zone 6
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone6 <- unlist(bi_bat_pitch_prop_zone6(batter))

## Zone 7
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone7 <- unlist(bi_bat_pitch_prop_zone7(batter))

## Zone 8
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone8 <- unlist(bi_bat_pitch_prop_zone8(batter))

## Zone 9
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone9 <- unlist(bi_bat_pitch_prop_zone9(batter))

## Zone 11
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone11 <- unlist(bi_bat_pitch_prop_zone11(batter))

## Zone 12
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone12 <- unlist(bi_bat_pitch_prop_zone12(batter))

## Zone 13
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone13 <- unlist(bi_bat_pitch_prop_zone13(batter))

## Zone 14
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone14 <- unlist(bi_bat_pitch_prop_zone14(batter))

## Zone 16
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}
bi_bat_pitch_prop_zone16 <- unlist(bi_bat_pitch_prop_zone16(batter))

## Zone 17
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 17)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone17 <- unlist(bi_bat_pitch_prop_zone17(batter))

## Zone 18
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 18)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone18 <- unlist(bi_bat_pitch_prop_zone18(batter))

## Zone 19
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 19)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone19 <- unlist(bi_bat_pitch_prop_zone19(batter))

## Zone 21
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 21)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone21 <- unlist(bi_bat_pitch_prop_zone21(batter))

## Zone 22
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 22)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone22 <- unlist(bi_bat_pitch_prop_zone22(batter))

## Zone 23
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 23)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone23 <-unlist(bi_bat_pitch_prop_zone23(batter))

## Zone 24
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 24)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone24 <- unlist(bi_bat_pitch_prop_zone24(batter))

## Zone 26
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 26)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone26 <- unlist(bi_bat_pitch_prop_zone26(batter))

## Zone 27
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 27)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone27 <- unlist(bi_bat_pitch_prop_zone27(batter))

## Zone 28
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 28)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}
bi_bat_pitch_prop_zone28 <- unlist(bi_bat_pitch_prop_zone28(batter))

## Zone 29
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 29)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}
bi_bat_pitch_prop_zone29 <- unlist(bi_bat_pitch_prop_zone29(batter))

## Zone 30
pitch_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 30)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_pitch_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, pitch_bat)

  return(x)
}

bi_bat_pitch_prop_zone30 <- unlist(bi_bat_pitch_prop_zone30(batter))

batters <- unlist(unique(statcast_2017_2018$batter))

batter_biseason1 <- data.frame(batters, biseason_bat_h_per_avg_pa, biseason_bat_hits, biseason_bat_avg_pa, biseason_bat_ba, bi_bat_pitch_prop_zone1, bi_bat_pitch_prop_zone2, bi_bat_pitch_prop_zone3, bi_bat_pitch_prop_zone4, bi_bat_pitch_prop_zone5, bi_bat_pitch_prop_zone6, bi_bat_pitch_prop_zone7, bi_bat_pitch_prop_zone8, bi_bat_pitch_prop_zone9, bi_bat_pitch_prop_zone11, bi_bat_pitch_prop_zone12, bi_bat_pitch_prop_zone13, bi_bat_pitch_prop_zone14, bi_bat_pitch_prop_zone16, bi_bat_pitch_prop_zone17, bi_bat_pitch_prop_zone18, bi_bat_pitch_prop_zone19, bi_bat_pitch_prop_zone21, bi_bat_pitch_prop_zone22, bi_bat_pitch_prop_zone23, bi_bat_pitch_prop_zone24, bi_bat_pitch_prop_zone26, bi_bat_pitch_prop_zone27, bi_bat_pitch_prop_zone28, bi_bat_pitch_prop_zone29, bi_bat_pitch_prop_zone30)

## Batter (biseason)
## Swing proportions by zone

## Zone 1
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone1 <- unlist(bi_bat_swing_prop_zone1(batter))

## Zone 2
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone2 <- unlist(bi_bat_swing_prop_zone2(batter))

## Zone 3
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone3 <- unlist(bi_bat_swing_prop_zone3(batter))

## Zone 4
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone4 <- unlist(bi_bat_swing_prop_zone4(batter))

## Zone 5
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone5 <- unlist(bi_bat_swing_prop_zone5(batter))

## Zone 6
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone6 <- unlist(bi_bat_swing_prop_zone6(batter))

## Zone 7
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone7 <- unlist(bi_bat_swing_prop_zone7(batter))

## Zone 8
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone8 <- unlist(bi_bat_swing_prop_zone8(batter))

## Zone 9
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone9 <- unlist(bi_bat_swing_prop_zone9(batter))

## Zone 11
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone11 <- unlist(bi_bat_swing_prop_zone11(batter))

## Zone 12
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone12 <- unlist(bi_bat_swing_prop_zone12(batter))

## Zone 13
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone13 <- unlist(bi_bat_swing_prop_zone13(batter))

## Zone 14
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone14 <- unlist(bi_bat_swing_prop_zone14(batter))

## Zone 16
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone16 <- unlist(bi_bat_swing_prop_zone16(batter))

## Zone 17
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 17)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone17 <- unlist(bi_bat_swing_prop_zone17(batter))

## Zone 18
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 18)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone18 <- unlist(bi_bat_swing_prop_zone18(batter))

## Zone 19
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 19)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone19 <- unlist(bi_bat_swing_prop_zone19(batter))

## Zone 21
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 21)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}
bi_bat_swing_prop_zone21 <- unlist(bi_bat_swing_prop_zone21(batter))

## Zone 22
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 22)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone22 <- unlist(bi_bat_swing_prop_zone22(batter))

## Zone 23
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 23)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone23 <- unlist(bi_bat_swing_prop_zone23(batter))

## Zone 24
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 24)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}
bi_bat_swing_prop_zone24 <- unlist(bi_bat_swing_prop_zone24(batter))

## Zone 26
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 26)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone26 <- unlist(bi_bat_swing_prop_zone26(batter))

## Zone 27
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 27)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone27 <- unlist(bi_bat_swing_prop_zone27(batter))

## Zone 28
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 28)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}
bi_bat_swing_prop_zone28 <- unlist(bi_bat_swing_prop_zone28(batter))

## Zone 29
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 29)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone29 <- unlist(bi_bat_swing_prop_zone29(batter))

## Zone 30
swing_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 1 | description == 2 | description == 3, zone == 30)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_swing_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, swing_bat)
  return(x)
}

bi_bat_swing_prop_zone30 <- unlist(bi_bat_swing_prop_zone30(batter))

batter_biseason2 <- data.frame(bi_bat_swing_prop_zone1, bi_bat_swing_prop_zone2, bi_bat_swing_prop_zone3, bi_bat_swing_prop_zone4, bi_bat_swing_prop_zone5, bi_bat_swing_prop_zone6, bi_bat_swing_prop_zone7, bi_bat_swing_prop_zone8, bi_bat_swing_prop_zone9, bi_bat_swing_prop_zone11, bi_bat_swing_prop_zone12, bi_bat_swing_prop_zone13, bi_bat_swing_prop_zone14, bi_bat_swing_prop_zone16, bi_bat_swing_prop_zone17, bi_bat_swing_prop_zone18, bi_bat_swing_prop_zone19, bi_bat_swing_prop_zone21, bi_bat_swing_prop_zone22, bi_bat_swing_prop_zone23, bi_bat_swing_prop_zone24, bi_bat_swing_prop_zone26, bi_bat_swing_prop_zone27, bi_bat_swing_prop_zone28, bi_bat_swing_prop_zone29, bi_bat_swing_prop_zone30)

## Batter (biseason)
## Whiff proportion per zone

## Zone 1
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone1 <- unlist(bi_bat_whiff_prop_zone1(batter))

## Zone 2
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone2 <- unlist(bi_bat_whiff_prop_zone2(batter))

## Zone 3
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone3 <- unlist(bi_bat_whiff_prop_zone3(batter))

## Zone 4
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone4 <- unlist(bi_bat_whiff_prop_zone4(batter))

## Zone 5
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone5 <- unlist(bi_bat_whiff_prop_zone5(batter))

## Zone 6
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone6 <- unlist(bi_bat_whiff_prop_zone6(batter))

## Zone 7
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone7 <- unlist(bi_bat_whiff_prop_zone7(batter))

## Zone 8
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone8 <- unlist(bi_bat_whiff_prop_zone8(batter))

## Zone 9
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone9 <- unlist(bi_bat_whiff_prop_zone9(batter))

## Zone 11
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone11 <- unlist(bi_bat_whiff_prop_zone11(batter))

## Zone 12
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone12 <- unlist(bi_bat_whiff_prop_zone12(batter))

## Zone 13
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone13 <- unlist(bi_bat_whiff_prop_zone13(batter))

## Zone 14
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone14 <- unlist(bi_bat_whiff_prop_zone14(batter))

## Zone 16
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone16 <- unlist(bi_bat_whiff_prop_zone16(batter))

## Zone 17
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 17)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone17 <- unlist(bi_bat_whiff_prop_zone17(batter))

## Zone 18
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 18)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone18 <- unlist(bi_bat_whiff_prop_zone18(batter))

## Zone 19
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 19)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}
bi_bat_whiff_prop_zone19 <- unlist(bi_bat_whiff_prop_zone19(batter))

## Zone 21
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 21)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone21 <- unlist(bi_bat_whiff_prop_zone21(batter))

## Zone 22
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 22)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone22 <- unlist(bi_bat_whiff_prop_zone22(batter))

## Zone 23
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 23)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone23 <- unlist(bi_bat_whiff_prop_zone23(batter))

## Zone 24
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 24)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone24 <- unlist(bi_bat_whiff_prop_zone24(batter))

## Zone 26
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 26)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone26 <- unlist(bi_bat_whiff_prop_zone26(batter))

## Zone 27
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 27)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone27 <- unlist(bi_bat_whiff_prop_zone27(batter))

## Zone 28
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 28)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone28 <- unlist(bi_bat_whiff_prop_zone28(batter))

## Zone 29
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 29)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone29 <- unlist(bi_bat_whiff_prop_zone29(batter))

## Zone 30
whiff_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, description == 2, zone == 30)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_whiff_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, whiff_bat)
  return(x)
}

bi_bat_whiff_prop_zone30 <- unlist(bi_bat_whiff_prop_zone30(batter))

batter_biseason3 <- data.frame(bi_bat_whiff_prop_zone1, bi_bat_whiff_prop_zone2, bi_bat_whiff_prop_zone3, bi_bat_whiff_prop_zone4, bi_bat_whiff_prop_zone5, bi_bat_whiff_prop_zone6, bi_bat_whiff_prop_zone7, bi_bat_whiff_prop_zone8, bi_bat_whiff_prop_zone9, bi_bat_whiff_prop_zone11, bi_bat_whiff_prop_zone12, bi_bat_whiff_prop_zone13, bi_bat_whiff_prop_zone14, bi_bat_whiff_prop_zone16, bi_bat_whiff_prop_zone17, bi_bat_whiff_prop_zone18, bi_bat_whiff_prop_zone19, bi_bat_whiff_prop_zone21, bi_bat_whiff_prop_zone22, bi_bat_whiff_prop_zone23, bi_bat_whiff_prop_zone24, bi_bat_whiff_prop_zone26, bi_bat_whiff_prop_zone27, bi_bat_whiff_prop_zone28, bi_bat_whiff_prop_zone29, bi_bat_whiff_prop_zone30)

## Batter (biseason)
## K+BB proportion per zone

## Zone 1
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 1)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 1)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone1 <- unlist(bi_bat_k_bb_prop_zone1(batter))

## Zone 2
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 2)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 2)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone2 <- unlist(bi_bat_k_bb_prop_zone2(batter))

## Zone 3
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 3)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 3)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone3 <- unlist(bi_bat_k_bb_prop_zone3(batter))

## Zone 4
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 4)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 4)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone4 <- unlist(bi_bat_k_bb_prop_zone4(batter))

## Zone 5
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 5)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 5)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone5 <- unlist(bi_bat_k_bb_prop_zone5(batter))

## Zone 6
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 6)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 6)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone6 <- unlist(bi_bat_k_bb_prop_zone6(batter))

## Zone 7
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 7)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 7)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone7 <- unlist(bi_bat_k_bb_prop_zone7(batter))

## Zone 8
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 8)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 8)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone8 <- unlist(bi_bat_k_bb_prop_zone8(batter))

## Zone 9
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 9)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 9)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone9 <- unlist(bi_bat_k_bb_prop_zone9(batter))

## Zone 11
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 11)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 11)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone11 <- unlist(bi_bat_k_bb_prop_zone11(batter))

## Zone 12
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 12)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 12)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone12 <- unlist(bi_bat_k_bb_prop_zone12(batter))

## Zone 13
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 13)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 13)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone13 <- unlist(bi_bat_k_bb_prop_zone13(batter))

## Zone 14
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 14)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 14)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone14 <- unlist(bi_bat_k_bb_prop_zone14(batter))

## Zone 16
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 16)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 16)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone16 <- unlist(bi_bat_k_bb_prop_zone16(batter))

## Zone 17
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 17)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 17)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone17 <- unlist(bi_bat_k_bb_prop_zone17(batter))

## Zone 18
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 18)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 18)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone18 <- unlist(bi_bat_k_bb_prop_zone18(batter))
```

```{r}
## Zone 19
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 19)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 19)
  zone <- nrow(batters)
  zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone19 <- unlist(bi_bat_k_bb_prop_zone19(batter))

## Zone 21
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 21)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 21)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone21 <- unlist(bi_bat_k_bb_prop_zone21(batter))

## Zone 22
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 22)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 22)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone22 <- unlist(bi_bat_k_bb_prop_zone22(batter))

## Zone 23
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 23)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 23)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone23 <- unlist(bi_bat_k_bb_prop_zone23(batter))

## Zone 24
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 24)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 24)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone24 <- unlist(bi_bat_k_bb_prop_zone24(batter))

## Zone 26
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 26)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 26)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone26 <- unlist(bi_bat_k_bb_prop_zone26(batter))

## Zone 27
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 27)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 27)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone27 <- unlist(bi_bat_k_bb_prop_zone27(batter))

## Zone 28
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 28)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 28)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone28 <- unlist(bi_bat_k_bb_prop_zone28(batter))

## Zone 29
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 29)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 29)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}

bi_bat_k_bb_prop_zone29 <- unlist(bi_bat_k_bb_prop_zone29(batter))

## Zone 30
k_bb_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, events == 4, zone == 30)
  batters1 <- filter(statcast_2008_2018, batter == x, events == 5, zone == 30)
  zone <- nrow(batters)
    zone1 <- nrow(batters1)
  zone <- zone + zone1
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_k_bb_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, k_bb_bat)
  return(x)
}


bi_bat_k_bb_prop_zone30 <- unlist(bi_bat_k_bb_prop_zone30(batter))

batter_biseason4 <- data.frame(bi_bat_k_bb_prop_zone1, bi_bat_k_bb_prop_zone2, bi_bat_k_bb_prop_zone3, bi_bat_k_bb_prop_zone4, bi_bat_k_bb_prop_zone5, bi_bat_k_bb_prop_zone6, bi_bat_k_bb_prop_zone7, bi_bat_k_bb_prop_zone8, bi_bat_k_bb_prop_zone9, bi_bat_k_bb_prop_zone11, bi_bat_k_bb_prop_zone12, bi_bat_k_bb_prop_zone13, bi_bat_k_bb_prop_zone14, bi_bat_k_bb_prop_zone16, bi_bat_k_bb_prop_zone17, bi_bat_k_bb_prop_zone18, bi_bat_k_bb_prop_zone19, bi_bat_k_bb_prop_zone21, bi_bat_k_bb_prop_zone22, bi_bat_k_bb_prop_zone23, bi_bat_k_bb_prop_zone24, bi_bat_k_bb_prop_zone26, bi_bat_k_bb_prop_zone27, bi_bat_k_bb_prop_zone28, bi_bat_k_bb_prop_zone29, bi_bat_k_bb_prop_zone30)

## Batter (biseason)
## Hit proportion per pitch type

## Pitch 0
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 0)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch0 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch0 <- unlist(bi_bat_hit_prop_pitch0(batter))

## Pitch 1
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch1 <- unlist(bi_bat_hit_prop_pitch1(batter))

## Pitch 2
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch2 <- unlist(bi_bat_hit_prop_pitch2(batter))

## Pitch 3
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch3 <- unlist(bi_bat_hit_prop_pitch3(batter))

## Pitch 4
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch4 <- unlist(bi_bat_hit_prop_pitch4(batter))

## Pitch 5
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch5 <- unlist(bi_bat_hit_prop_pitch5(batter))

## Pitch 6
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch6 <- unlist(bi_bat_hit_prop_pitch6(batter))

## Pitch 7
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch7 <- unlist(bi_bat_hit_prop_pitch7(batter))

## Pitch 8
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch8 <- unlist(bi_bat_hit_prop_pitch8(batter))

## Pitch 9
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch9 <- unlist(bi_bat_hit_prop_pitch9(batter))

## Pitch 10
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 10)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch10 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}
bi_bat_hit_prop_pitch10 <- unlist(bi_bat_hit_prop_pitch10(batter))

## Pitch 11
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch11 <- unlist(bi_bat_hit_prop_pitch11(batter))

## Pitch 12
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch12 <- unlist(bi_bat_hit_prop_pitch12(batter))

## Pitch 13
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}
bi_bat_hit_prop_pitch13 <- unlist(bi_bat_hit_prop_pitch13(batter))

## Pitch 14
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch14 <- unlist(bi_bat_hit_prop_pitch14(batter))

## Pitch 15
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 15)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch15 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch15 <- unlist(bi_bat_hit_prop_pitch15(batter))

## Pitch 16
hit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 1, pitch_type == 16)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_hit_prop_pitch16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, hit_bat)
  return(x)
}

bi_bat_hit_prop_pitch16 <- unlist(bi_bat_hit_prop_pitch16(batter))

batter_biseason5 <- data.frame(bi_bat_hit_prop_pitch0, bi_bat_hit_prop_pitch1, bi_bat_hit_prop_pitch2, bi_bat_hit_prop_pitch3, bi_bat_hit_prop_pitch4, bi_bat_hit_prop_pitch5, bi_bat_hit_prop_pitch6, bi_bat_hit_prop_pitch7, bi_bat_hit_prop_pitch8, bi_bat_hit_prop_pitch9, bi_bat_hit_prop_pitch10, bi_bat_hit_prop_pitch11, bi_bat_hit_prop_pitch12, bi_bat_hit_prop_pitch13, bi_bat_hit_prop_pitch14, bi_bat_hit_prop_pitch15, bi_bat_hit_prop_pitch16)
```

```{r}

## Batter (biseason)
## No hits per pitch type

## Pitch 0
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 0)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch0 <- unlist(bi_bat_nohit_prop_pitch1(batter))

## Pitch 1
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 1)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch1 <- unlist(bi_bat_nohit_prop_pitch2(batter))

## Pitch 2
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 2)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch2 <- unlist(bi_bat_nohit_prop_pitch3(batter))

## Pitch 3
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 3)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch3 <- unlist(bi_bat_nohit_prop_pitch4(batter))

## Pitch 4
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 4)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch4 <- unlist(bi_bat_nohit_prop_pitch5(batter))

## Pitch 5
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 5)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch5 <- unlist(bi_bat_nohit_prop_pitch6(batter))

## Pitch 6
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 6)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch6 <- unlist(bi_bat_nohit_prop_pitch7(batter))

## Pitch 7
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 7)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch7 <- unlist(bi_bat_nohit_prop_pitch8(batter))

## Pitch 8
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 8)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch8 <- unlist(bi_bat_nohit_prop_pitch9(batter))

## Pitch 9
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 9)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch9 <- unlist(bi_bat_nohit_prop_pitch11(batter))

## Pitch 10
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 10)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch10 <- unlist(bi_bat_nohit_prop_pitch12(batter))

## Pitch 11
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 11)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch11 <- unlist(bi_bat_nohit_prop_pitch13(batter))

## Pitch 12
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 12)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch12 <- unlist(bi_bat_nohit_prop_pitch14(batter))

## Pitch 13
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 13)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch13 <- unlist(bi_bat_nohit_prop_pitch16(batter))

## Pitch 14
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 14)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch14 <- unlist(bi_bat_nohit_prop_pitch17(batter))

## Pitch 15
nohit_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, bb_type == 0, pitch_type == 15)
  zone <- nrow(batters)
  prop <- zone/(nrow(filter(statcast_2008_2018, batter == x)))
  return(prop)
}
bi_bat_nohit_prop_pitch18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, nohit_bat)
  return(x)
}

bi_bat_nohit_prop_pitch15 <- unlist(bi_bat_nohit_prop_pitch18(batter))

batter_biseason6 <- data.frame(bi_bat_nohit_prop_pitch0, bi_bat_nohit_prop_pitch1, bi_bat_nohit_prop_pitch2, bi_bat_nohit_prop_pitch3, bi_bat_nohit_prop_pitch4, bi_bat_nohit_prop_pitch5, bi_bat_nohit_prop_pitch6, bi_bat_nohit_prop_pitch7, bi_bat_nohit_prop_pitch8, bi_bat_nohit_prop_pitch9, bi_bat_nohit_prop_pitch10, bi_bat_nohit_prop_pitch11, bi_bat_nohit_prop_pitch12, bi_bat_nohit_prop_pitch13, bi_bat_nohit_prop_pitch14, bi_bat_nohit_prop_pitch15)
```

```{r}
## Batter (biseason)
## BA by zone (hits per zone divided by total pa)

## Zone 1
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 1)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone1 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone1 <- unlist(bi_bat_ba_prop_zone1(batter))

## Zone 2
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 2)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone2 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone2 <- unlist(bi_bat_ba_prop_zone2(batter))

## Zone 3
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 3)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone3 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone3 <- unlist(bi_bat_ba_prop_zone3(batter))

## Zone 4
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 4)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone4 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone4 <- unlist(bi_bat_ba_prop_zone4(batter))

## Zone 5
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 5)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone5 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone5 <- unlist(bi_bat_ba_prop_zone5(batter))

## Zone 6
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 6)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone6 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone6 <- unlist(bi_bat_ba_prop_zone6(batter))

## Zone 7
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 7)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone7 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone7 <- unlist(bi_bat_ba_prop_zone7(batter))

## Zone 8
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 8)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone8 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone8 <- unlist(bi_bat_ba_prop_zone8(batter))

## Zone 9
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 9)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone9 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone9 <- unlist(bi_bat_ba_prop_zone9(batter))

## Zone 11
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 11)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone11 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone11 <- unlist(bi_bat_ba_prop_zone11(batter))

## Zone 12
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 12)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone12 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone12 <- unlist(bi_bat_ba_prop_zone12(batter))

## Zone 13
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 13)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone13 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone13 <- unlist(bi_bat_ba_prop_zone13(batter))

## Zone 14
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 14)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone14 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone14 <- unlist(bi_bat_ba_prop_zone14(batter))

## Zone 16
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 16)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone16 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone16 <- unlist(bi_bat_ba_prop_zone16(batter))

## Zone 17
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 17)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone17 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone17 <- unlist(bi_bat_ba_prop_zone17(batter))

## Zone 18
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 18)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone18 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone18 <- unlist(bi_bat_ba_prop_zone18(batter))

## Zone 19
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 19)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone19 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone19 <- unlist(bi_bat_ba_prop_zone19(batter))

## Zone 21
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 21)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone21 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone21 <- unlist(bi_bat_ba_prop_zone21(batter))

## Zone 22
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 22)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone22 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone22 <- unlist(bi_bat_ba_prop_zone22(batter))

## Zone 23
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 23)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone23 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone23 <- unlist(bi_bat_ba_prop_zone23(batter))

## Zone 24
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 24)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone24 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone24 <- unlist(bi_bat_ba_prop_zone24(batter))

## Zone 26
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 26)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone26 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone26 <- unlist(bi_bat_ba_prop_zone26(batter))

## Zone 27
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 27)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone27 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone27 <- unlist(bi_bat_ba_prop_zone27(batter))

## Zone 28
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 28)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone28 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}

bi_bat_ba_prop_zone28 <- unlist(bi_bat_ba_prop_zone28(batter))

## Zone 29
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 29)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone29 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone29 <- unlist(bi_bat_ba_prop_zone29(batter))

## Zone 30
ba_bat <- function(x){
  batters <- filter(statcast_2008_2018, batter == x, zone == 30)
  zone <- nrow(batters)
  prop <- zone/((biseason_bat_stats %>% filter(batter == x))[,4])
  return(prop)
}
bi_bat_ba_prop_zone30 <- function(batter){
  batters <- unique(statcast_2017_2018$batter)
  x <- lapply(batters, ba_bat)
  return(x)
}
bi_bat_ba_prop_zone30 <- unlist(bi_bat_ba_prop_zone30(batter))

batter_biseason7 <- data.frame(bi_bat_ba_prop_zone1, bi_bat_ba_prop_zone2, bi_bat_ba_prop_zone3, bi_bat_ba_prop_zone4, bi_bat_ba_prop_zone5, bi_bat_ba_prop_zone6, bi_bat_ba_prop_zone7, bi_bat_ba_prop_zone8, bi_bat_ba_prop_zone9, bi_bat_ba_prop_zone11, bi_bat_ba_prop_zone12, bi_bat_ba_prop_zone13, bi_bat_ba_prop_zone14, bi_bat_ba_prop_zone16, bi_bat_ba_prop_zone17, bi_bat_ba_prop_zone18, bi_bat_ba_prop_zone19, bi_bat_ba_prop_zone21, bi_bat_ba_prop_zone22, bi_bat_ba_prop_zone23, bi_bat_ba_prop_zone24, bi_bat_ba_prop_zone26, bi_bat_ba_prop_zone27, bi_bat_ba_prop_zone28, bi_bat_ba_prop_zone29, bi_bat_ba_prop_zone30)

## Dataframe of batter biseason stats
batter_biseason <- bind_cols(batter_biseason1, batter_biseason2, batter_biseason3, batter_biseason4, batter_biseason5, batter_biseason6, batter_biseason7)

write.csv(batter_biseason, "Batter_Biseason.csv")
write.csv(pitcher_career, "Pitcher_Career.csv")
write.csv(batter_career, "Batter_Career.csv")
```

```{r}
#############################################

## Pitcher (2017-2018)
biseason_pit_FIP <- (13*(biseason_pit_stats$Biseason_pit_HR)+3*(biseason_pit_stats$Biseason_pit_HBP+biseason_pit_stats$Biseason_pit_BB)-2*(biseason_pit_stats$Biseason_pit_K))/(biseason_pit_stats$Biseason_pit_IP) + ((league_stats$cFIP[1]+league_stats$cFIP[2])/2)
biseason_pit_h9 <- ((biseason_pit_stats$Biseason_pit_H)*9)/(biseason_pit_stats$Biseason_pit_IP)
biseason_pit_noh9 <- ((biseason_pit_stats$Biseason_pit_K + biseason_pit_stats$Biseason_pit_BB)*9)/(biseason_pit_stats$Biseason_pit_IP)
biseason_pit_k_bb <- (biseason_pit_stats$Biseason_pit_K)/(biseason_pit_stats$Biseason_pit_BB)
biseason_pit_hits <- biseason_pit_stats$Biseason_pit_H
biseason_pit_avg_ip <- (biseason_pit_stats$Biseason_pit_IP)/(biseason_pit_stats$Biseason_pit_G)
biseason_pit_ba <- (biseason_pit_stats$Biseason_pit_H)/((biseason_pit_stats$Biseason_pit_BF) - (biseason_pit_stats$Biseason_pit_BB))

pitcher_biseason1 <- data.frame(unlist(biseason_pit_FIP), unlist(biseason_pit_h9), unlist(biseason_pit_noh9), unlist(biseason_pit_k_bb), unlist(biseason_pit_hits), unlist(biseason_pit_avg_ip), unlist(biseason_pit_ba))
```

```{r}
## Pitcher (biseason)
## BA by zone (hits per zone divided by total pa)

## Zone 1
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 1)
  zone <- nrow(pitchers)
  prop <- zone/(biseason_pit_stats %>% filter(pitcher == x))[,10]
  return(prop)
}
bi_pit_ba_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone1 <- unlist(bi_pit_ba_prop_zone1(pitcher))

## Zone 2
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 2)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone2 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone2 <- unlist(bi_pit_ba_prop_zone2(pitcher))

## Zone 3
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 3)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone3 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone3 <- unlist(bi_pit_ba_prop_zone3(pitcher))

## Zone 4
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 4)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone4 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone4 <- unlist(bi_pit_ba_prop_zone4(batter))

## Zone 5
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 5)
  zone <- nrow(pitchers)
  prop <- zone/((biseason_pit_stats %>% filter(pitcher == x))[,10])
  return(prop)
}
bi_pit_ba_prop_zone5 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone5 <- unlist(bi_pit_ba_prop_zone5(pitcher))

## Zone 6
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 6)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone6 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone6 <- unlist(bi_pit_ba_prop_zone6(pitcher))

## Zone 7
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 7)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone7 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone7 <- unlist(bi_pit_ba_prop_zone7(pitcher))

## Zone 8
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 8)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone8 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone8 <- unlist(bi_pit_ba_prop_zone8(pitcher))

## Zone 9
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 9)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone9 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone9 <- unlist(bi_pit_ba_prop_zone9(pitcher))

## Zone 11
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 11)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone11 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone11 <- unlist(bi_pit_ba_prop_zone11(pitcher))

## Zone 12
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 12)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone12 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone12 <- unlist(bi_pit_ba_prop_zone12(pitcher))

## Zone 13
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 13)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone13 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone13 <- unlist(bi_pit_ba_prop_zone13(pitcher))

## Zone 14
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 14)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone14 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone14 <- unlist(bi_pit_ba_prop_zone14(pitcher))

## Zone 16
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 16)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone16 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone16 <- unlist(bi_pit_ba_prop_zone16(pitcher))

## Zone 17
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 17)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone17 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone17 <- unlist(bi_pit_ba_prop_zone17(pitcher))

## Zone 18
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 18)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone18 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone18 <- unlist(bi_pit_ba_prop_zone18(pitcher))

## Zone 19
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 19)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone19 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone19 <- unlist(bi_pit_ba_prop_zone19(pitcher))

## Zone 21
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 21)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone21 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone21 <- unlist(bi_pit_ba_prop_zone21(pitcher))

## Zone 22
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 22)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone22 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone22 <- unlist(bi_pit_ba_prop_zone22(pitcher))

## Zone 23
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 23)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone23 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone23 <- unlist(bi_pit_ba_prop_zone23(pitcher))

## Zone 24
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 24)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone24 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone24 <- unlist(bi_pit_ba_prop_zone24(pitcher))

## Zone 26
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 26)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone26 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone26 <- unlist(bi_pit_ba_prop_zone26(pitcher))

## Zone 27
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 27)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone27 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone27 <- unlist(bi_pit_ba_prop_zone27(pitcher))

## Zone 28
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 28)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone28 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone28 <- unlist(bi_pit_ba_prop_zone28(pitcher))

## Zone 29
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 29)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone29 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone29 <- unlist(bi_pit_ba_prop_zone29(pitcher))

## Zone 30
ba_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 30)
  zone <- nrow(pitchers)
  prop <- zone/(((biseason_pit_stats %>% filter(pitcher == x))[,10]))
  return(prop)
}
bi_pit_ba_prop_zone30 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, ba_pit)
  return(x)
}
bi_pit_ba_prop_zone30 <- unlist(bi_pit_ba_prop_zone30(pitcher))

pitchers <- unlist(unique(statcast_2017_2018$pitcher))

pitcher_biseason2 <- data.frame(bi_pit_ba_prop_zone1, bi_pit_ba_prop_zone2, bi_pit_ba_prop_zone3, bi_pit_ba_prop_zone4, bi_pit_ba_prop_zone5, bi_pit_ba_prop_zone6, bi_pit_ba_prop_zone7, bi_pit_ba_prop_zone8, bi_pit_ba_prop_zone9, bi_pit_ba_prop_zone11, bi_pit_ba_prop_zone12, bi_pit_ba_prop_zone13, bi_pit_ba_prop_zone14, bi_pit_ba_prop_zone16, bi_pit_ba_prop_zone17, bi_pit_ba_prop_zone18, bi_pit_ba_prop_zone19, bi_pit_ba_prop_zone21, bi_pit_ba_prop_zone22, bi_pit_ba_prop_zone23, bi_pit_ba_prop_zone24, bi_pit_ba_prop_zone26, bi_pit_ba_prop_zone27, bi_pit_ba_prop_zone28, bi_pit_ba_prop_zone29, bi_pit_ba_prop_zone30)
```

```{r}
## Pitcher (biseason)
## Pitch proportions by zone

## Zone 1
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone1 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 2
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone2 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 3
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone3 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 4
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone4 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 5
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone5 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 6
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone6 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 7
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone7 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 8
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone8 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 9
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone9 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 11
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone11 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 12
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone12 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 13
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone13 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 14
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone14 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 16
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit__pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone16 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 17
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone17 <- unlist(bi_pit_pitches_prop_zone1(pitcher))
## Zone 18
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone18 <- unlist(bi_pit_pitches_prop_zone1(pitcher))
## Zone 19
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone19 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 21
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone21 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 22
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone22 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 23
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone23 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 24
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone24 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 26
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone26 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 27
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone27 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 28
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone28 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 29
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone29 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

## Zone 30
pitches_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, zone == 30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_pitches_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, pitches_pit)
  return(x)
}
bi_pit_pitches_prop_zone30 <- unlist(bi_pit_pitches_prop_zone1(pitcher))
bi_pit_pitches_prop_zone1 <- unlist(bi_pit_pitches_prop_zone1(pitcher))

pitcher_biseason3 <- data.frame(bi_pit_pitches_prop_zone1, bi_pit_pitches_prop_zone2, bi_pit_pitches_prop_zone3, bi_pit_pitches_prop_zone4, bi_pit_pitches_prop_zone5, bi_pit_pitches_prop_zone6, bi_pit_pitches_prop_zone7, bi_pit_pitches_prop_zone8, bi_pit_pitches_prop_zone9, bi_pit_pitches_prop_zone11, bi_pit_pitches_prop_zone12, bi_pit_pitches_prop_zone13, bi_pit_pitches_prop_zone14, bi_pit_pitches_prop_zone16, bi_pit_pitches_prop_zone17, bi_pit_pitches_prop_zone18, bi_pit_pitches_prop_zone19, bi_pit_pitches_prop_zone21, bi_pit_pitches_prop_zone22, bi_pit_pitches_prop_zone23, bi_pit_pitches_prop_zone24, bi_pit_pitches_prop_zone26, bi_pit_pitches_prop_zone27, bi_pit_pitches_prop_zone28, bi_pit_pitches_prop_zone29, bi_pit_pitches_prop_zone30)

## Pitcher (biseason)
## Swing proportion by zone

## Zone 1
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone1 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 2
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone2 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 3
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone3 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 4
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone4 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 5
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone5 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 6
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone6 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 7
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone7 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 8
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone8 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 9
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone9 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 11
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone11 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 12
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone12 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 13
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone13 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 14
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone14 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 16
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit__swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone16 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 17
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone17 <- unlist(bi_pit_swings_prop_zone1(pitcher))
## Zone 18
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone18 <- unlist(bi_pit_swings_prop_zone1(pitcher))
## Zone 19
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone19 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 21
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone21 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 22
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone22 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 23
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone23 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 24
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone24 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 26
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone26 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 27
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone27 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 28
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone28 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 29
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone29 <- unlist(bi_pit_swings_prop_zone1(pitcher))

## Zone 30
swings_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 1 | description == 2 | description == 3, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_swings_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, swings_pit)
  return(x)
}
bi_pit_swings_prop_zone30 <- unlist(bi_pit_swings_prop_zone1(pitcher))
bi_pit_swings_prop_zone1 <- unlist(bi_pit_swings_prop_zone1(pitcher))

pitcher_biseason4 <- data.frame(bi_pit_swings_prop_zone1, bi_pit_swings_prop_zone2, bi_pit_swings_prop_zone3, bi_pit_swings_prop_zone4, bi_pit_swings_prop_zone5, bi_pit_swings_prop_zone6, bi_pit_swings_prop_zone7, bi_pit_swings_prop_zone8, bi_pit_swings_prop_zone9, bi_pit_swings_prop_zone11, bi_pit_swings_prop_zone12, bi_pit_swings_prop_zone13, bi_pit_swings_prop_zone14, bi_pit_swings_prop_zone16, bi_pit_swings_prop_zone17, bi_pit_swings_prop_zone18, bi_pit_swings_prop_zone19, bi_pit_swings_prop_zone21, bi_pit_swings_prop_zone22, bi_pit_swings_prop_zone23, bi_pit_swings_prop_zone24, bi_pit_swings_prop_zone26, bi_pit_swings_prop_zone27, bi_pit_swings_prop_zone28, bi_pit_swings_prop_zone29, bi_pit_swings_prop_zone30)

## Pitcher (biseason)
## Whiffs proportion per zone

## Zone 1
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone1 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 2
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone2 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 3
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone3 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 4
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone4 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 5
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone5 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 6
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone6 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 7
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone7 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 8
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone8 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 9
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone9 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 11
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone11 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 12
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone12 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 13
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone13 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 14
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone14 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 16
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit__whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone16 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 17
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone17 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))
## Zone 18
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone18 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))
## Zone 19
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone19 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 21
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone21 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 22
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone22 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 23
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone23 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 24
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone24 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 26
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone26 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 27
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone27 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 28
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone28 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 29
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone29 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

## Zone 30
whiffs_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, description == 2, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_whiffs_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, whiffs_pit)
  return(x)
}
bi_pit_whiffs_prop_zone30 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))
bi_pit_whiffs_prop_zone1 <- unlist(bi_pit_whiffs_prop_zone1(pitcher))

pitcher_biseason5 <- data.frame(bi_pit_whiffs_prop_zone1, bi_pit_whiffs_prop_zone2, bi_pit_whiffs_prop_zone3, bi_pit_whiffs_prop_zone4, bi_pit_whiffs_prop_zone5, bi_pit_whiffs_prop_zone6, bi_pit_whiffs_prop_zone7, bi_pit_whiffs_prop_zone8, bi_pit_whiffs_prop_zone9, bi_pit_whiffs_prop_zone11, bi_pit_whiffs_prop_zone12, bi_pit_whiffs_prop_zone13, bi_pit_whiffs_prop_zone14, bi_pit_whiffs_prop_zone16, bi_pit_whiffs_prop_zone17, bi_pit_whiffs_prop_zone18, bi_pit_whiffs_prop_zone19, bi_pit_whiffs_prop_zone21, bi_pit_whiffs_prop_zone22, bi_pit_whiffs_prop_zone23, bi_pit_whiffs_prop_zone24, bi_pit_whiffs_prop_zone26, bi_pit_whiffs_prop_zone27, bi_pit_whiffs_prop_zone28, bi_pit_whiffs_prop_zone29, bi_pit_whiffs_prop_zone30)

## Pitcher (biseason)
## Hit proportion by zone

## Zone 1
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone1 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 2
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone2 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 3
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone3 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 4
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone4 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 5
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone5 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 6
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone6 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 7
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone7 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 8
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone8 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 9
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone9 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 11
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone11 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 12
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone12 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 13
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone13 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 14
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone14 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 16
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit__hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone16 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 17
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone17 <- unlist(bi_pit_hits_prop_zone1(pitcher))
## Zone 18
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone18 <- unlist(bi_pit_hits_prop_zone1(pitcher))
## Zone 19
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone19 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 21
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone21 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 22
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone22 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 23
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone23 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 24
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone24 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 26
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone26 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 27
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone27 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 28
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone28 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 29
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone29 <- unlist(bi_pit_hits_prop_zone1(pitcher))

## Zone 30
hits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 1, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_hits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, hits_pit)
  return(x)
}
bi_pit_hits_prop_zone30 <- unlist(bi_pit_hits_prop_zone1(pitcher))
bi_pit_hits_prop_zone1 <- unlist(bi_pit_hits_prop_zone1(pitcher))

pitcher_biseason6 <- data.frame(bi_pit_hits_prop_zone1, bi_pit_hits_prop_zone2, bi_pit_hits_prop_zone3, bi_pit_hits_prop_zone4, bi_pit_hits_prop_zone5, bi_pit_hits_prop_zone6, bi_pit_hits_prop_zone7, bi_pit_hits_prop_zone8, bi_pit_hits_prop_zone9, bi_pit_hits_prop_zone11, bi_pit_hits_prop_zone12, bi_pit_hits_prop_zone13, bi_pit_hits_prop_zone14, bi_pit_hits_prop_zone16, bi_pit_hits_prop_zone17, bi_pit_hits_prop_zone18, bi_pit_hits_prop_zone19, bi_pit_hits_prop_zone21, bi_pit_hits_prop_zone22, bi_pit_hits_prop_zone23, bi_pit_hits_prop_zone24, bi_pit_hits_prop_zone26, bi_pit_hits_prop_zone27, bi_pit_hits_prop_zone28, bi_pit_hits_prop_zone29, bi_pit_hits_prop_zone30)

## Pitcher (biseason)
## No hit (K+BB) proportion by zone

## Zone 1
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==1)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone1 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 2
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==2)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone2 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 3
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==3)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone3 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 4
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==4)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone4 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 5
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==5)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone5 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 6
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==6)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone6 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 7
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==7)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone7 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 8
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==8)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone8 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 9
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==9)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone9 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 11
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==11)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone11 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 12
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==12)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone12 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 13
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==13)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone13 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 14
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==14)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone14 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 16
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==16)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit__nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone16 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 17
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==17)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone17 <- unlist(bi_pit_nohits_prop_zone1(pitcher))
## Zone 18
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==18)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone18 <- unlist(bi_pit_nohits_prop_zone1(pitcher))
## Zone 19
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==19)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone19 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 21
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==21)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone21 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 22
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==22)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone22 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 23
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==23)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone23 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 24
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==24)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone24 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 26
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==26)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone26 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 27
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==27)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone27 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 28
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==28)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone28 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 29
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==29)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone29 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

## Zone 30
nohits_pit <- function(x){
  pitchers <- filter(statcast_2008_2018, pitcher == x, bb_type == 0, zone ==30)
  zone <- nrow(pitchers)
  prop <- zone/nrow(filter(statcast_2008_2018, pitcher == x))
  return(prop)
}
bi_pit_nohits_prop_zone1 <- function(pitcher){
  pitchers <- unique(statcast_2017_2018$pitcher)
  x <- lapply(pitchers, nohits_pit)
  return(x)
}
bi_pit_nohits_prop_zone30 <- unlist(bi_pit_nohits_prop_zone1(pitcher))
bi_pit_nohits_prop_zone1 <- unlist(bi_pit_nohits_prop_zone1(pitcher))

pitcher <- unique(statcast_2017_2018$pitcher)

pitcher_biseason7 <- data.frame(pitcher, bi_pit_nohits_prop_zone1, bi_pit_nohits_prop_zone2, bi_pit_nohits_prop_zone3, bi_pit_nohits_prop_zone4, bi_pit_nohits_prop_zone5, bi_pit_nohits_prop_zone6, bi_pit_nohits_prop_zone7, bi_pit_nohits_prop_zone8, bi_pit_nohits_prop_zone9, bi_pit_nohits_prop_zone11, bi_pit_nohits_prop_zone12, bi_pit_nohits_prop_zone13, bi_pit_nohits_prop_zone14, bi_pit_nohits_prop_zone16, bi_pit_nohits_prop_zone17, bi_pit_nohits_prop_zone18, bi_pit_nohits_prop_zone19, bi_pit_nohits_prop_zone21, bi_pit_nohits_prop_zone22, bi_pit_nohits_prop_zone23, bi_pit_nohits_prop_zone24, bi_pit_nohits_prop_zone26, bi_pit_nohits_prop_zone27, bi_pit_nohits_prop_zone28, bi_pit_nohits_prop_zone29, bi_pit_nohits_prop_zone30)
```

```{r}
pitcher_biseason <- bind_cols(pitcher_biseason1, pitcher_biseason2, pitcher_biseason3, pitcher_biseason4, pitcher_biseason5, pitcher_biseason6, pitcher_biseason7)
```

```{r}
colnames(batter_biseason)[colnames(batter_biseason) == "batters"] <- "batter"
```

```{r}
batter_stats <- merge(batter_career, batter_biseason, by = "batter")
pitcher_stats <- merge(pitcher_career, pitcher_biseason, by = "pitcher")
```

```{r}
test_a <- merge(statcast_2017_2018[1:50000,], batter_stats, by = "batter")
test_a <- merge(test_a, pitcher_stats, by = "pitcher")

test_b <- merge(statcast_2017_2018[50001:100000,], batter_stats, by = "batter")
test_b <- merge(test_b, pitcher_stats, by = "pitcher")

test_c <- merge(statcast_2017_2018[100001:200000,], batter_stats, by = "batter")
test_c <- merge(test_c, pitcher_stats, by = "pitcher")

test_d <- merge(statcast_2017_2018[200001:300000,], batter_stats, by = "batter")
test_d <- merge(test_d, pitcher_stats, by = "pitcher")

test_e <- merge(statcast_2017_2018[300001:400000,], batter_stats, by = "batter")
test_e <- merge(test_e, pitcher_stats, by = "pitcher")

test_f <- merge(statcast_2017_2018[400001:500000,], batter_stats, by = "batter")
test_f <- merge(test_f, pitcher_stats, by = "pitcher")

test_g <- merge(statcast_2017_2018[500001:600000,], batter_stats, by = "batter")
test_g <- merge(test_g, pitcher_stats, by = "pitcher")

test_h <- merge(statcast_2017_2018[600001:1000000,], batter_stats, by = "batter")
test_h <- merge(test_h, pitcher_stats, by = "pitcher")

test_i <- merge(statcast_2017_2018[1000001:1288189,], batter_stats, by = "batter")
test_i <- merge(test_i, pitcher_stats, by = "pitcher")

statcast_2017_2018 <- rbind(test_a, test_b, test_c, test_d, test_e, test_f, test_g, test_h, test_i)

write.csv(statcast_2017_2018, "Statcast_2017_2018.csv")
```

```{r}
merge_statcast_2017_2018 <- statcast_2008_2018 %>% filter(game_date >= "2017-04-02", game_date <= "2018-10-01")

merge_statcast_2017_2018$X1 <- NULL
merge_statcast_2017_2018$plate_z <- NULL
merge_statcast_2017_2018$X1_1 <- NULL
merge_statcast_2017_2018$pfx_x <- NULL
merge_statcast_2017_2018$pfx_z <- NULL
merge_statcast_2017_2018$plate_x <- NULL

part_a <- merge(merge_statcast_2017_2018, statcast_2017_2018[1:250000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_b <- merge(merge_statcast_2017_2018, statcast_2017_2018[250001:500000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_c <- merge(merge_statcast_2017_2018, statcast_2017_2018[500001:750000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_d <- merge(merge_statcast_2017_2018, statcast_2017_2018[750001:900000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_e <- merge(merge_statcast_2017_2018, statcast_2017_2018[900001:1000000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_f <- merge(merge_statcast_2017_2018, statcast_2017_2018[1000001:1050000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_g <- merge(merge_statcast_2017_2018, statcast_2017_2018[1050001:1100000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_h <- merge(merge_statcast_2017_2018, statcast_2017_2018[1100001:1150000,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part_i <- merge(merge_statcast_2017_2018, statcast_2017_2018[1150001:1288189,], by = c("pitcher", "sz_top", "sz_bot", "release_spin_rate", "game_date", "pitch_number", "pitch_type", "release_speed", "stand", "p_throws", "home_team", "away_team", "type", "balls", "strikes", "effective_speed", "release_extension", "game_pk", "batter"))
part <- rbind(part_a, part_b, part_c, part_d, part_e, part_f, part_g, part_h, part_i)
```

```{r}
statcast_2017_2018$sz_bot <- NULL
statcast_2017_2018$sz_top <- NULL
statcast_2017_2018$X1 <- NULL
statcast_2017_2018$X1_1 <- NULL
statcast_2017_2018$plate_x <- NULL
statcast_2017_2018$plate_z <- NULL
statcast_2017_2018$X1_2 <- NULL
names(statcast_2017_2018)
```

```{r}
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_FIP."] <- "biseason_pit_FIP"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_noh9."] <- "biseason_pit_noh9"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_h9."] <- "biseason_pit_h"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_k_bb."] <- "biseason_pit_k_bb"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_hits."] <- "biseason_pit_hits"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_avg_ip."] <- "biseason_pit_avg_ip"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.biseason_pit_ba."] <- "biseason_pit_ba"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_FIP."] <- "car_pit_FIP"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_noh9."] <- "car_pit_noh9"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_h9."] <- "car_pit_h"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_k_bb."] <- "car_pit_k_bb"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_hits."] <- "car_pit_hits"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_avg_ip."] <- "car_pit_avg_ip"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018) == "unlist.car_pit_ba."] <- "car_pit_ba"
```

```{r}
head(statcast_2017_2018)
str(statcast_2017_2018)
names(statcast_2017_2018)
```

```{r}
a <- (statcast_2017_2018[82:107])*(statcast_2017_2018[420:445])
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone1"] <- "mat_car_pitch_prop_zone1"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone2"] <- "mat_car_pitch_prop_zone2"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone3"] <- "mat_car_pitch_prop_zone3"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone4"] <- "mat_car_pitch_prop_zone4"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone5"] <- "mat_car_pitch_prop_zone5"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone6"] <- "mat_car_pitch_prop_zone6"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone7"] <- "mat_car_pitch_prop_zone7"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone8"] <- "mat_car_pitch_prop_zone8"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone9"] <- "mat_car_pitch_prop_zone9"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone11"] <- "mat_car_pitch_prop_zone11"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone12"] <- "mat_car_pitch_prop_zone12"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone13"] <- "mat_car_pitch_prop_zone13"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone14"] <- "mat_car_pitch_prop_zone14"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone16"] <- "mat_car_pitch_prop_zone16"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone17"] <- "mat_car_pitch_prop_zone17"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone18"] <- "mat_car_pitch_prop_zone18"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone19"] <- "mat_car_pitch_prop_zone19"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone21"] <- "mat_car_pitch_prop_zone21"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone22"] <- "mat_car_pitch_prop_zone22"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone23"] <- "mat_car_pitch_prop_zone23"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone24"] <- "mat_car_pitch_prop_zone24"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone26"] <- "mat_car_pitch_prop_zone26"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone27"] <- "mat_car_pitch_prop_zone27"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone28"] <- "mat_car_pitch_prop_zone28"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone29"] <- "mat_car_pitch_prop_zone29"
colnames(a)[colnames(a)=="car_bat_pitch_prop_zone30"] <- "mat_car_pitch_prop_zone30"
b <- (statcast_2017_2018[108:133])*(statcast_2017_2018[472:497])
colnames(b)[colnames(b)=="car_bat_swing_prop_zone1"] <- "mat_car_swing_prop_zone1"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone2"] <- "mat_car_swing_prop_zone2"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone3"] <- "mat_car_swing_prop_zone3"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone4"] <- "mat_car_swing_prop_zone4"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone5"] <- "mat_car_swing_prop_zone5"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone6"] <- "mat_car_swing_prop_zone6"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone7"] <- "mat_car_swing_prop_zone7"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone8"] <- "mat_car_swing_prop_zone8"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone9"] <- "mat_car_swing_prop_zone9"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone11"] <- "mat_car_swing_prop_zone11"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone12"] <- "mat_car_swing_prop_zone12"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone13"] <- "mat_car_swing_prop_zone13"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone14"] <- "mat_car_swing_prop_zone14"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone16"] <- "mat_car_swing_prop_zone16"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone17"] <- "mat_car_swing_prop_zone17"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone18"] <- "mat_car_swing_prop_zone18"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone19"] <- "mat_car_swing_prop_zone19"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone21"] <- "mat_car_swing_prop_zone21"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone22"] <- "mat_car_swing_prop_zone22"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone23"] <- "mat_car_swing_prop_zone23"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone24"] <- "mat_car_swing_prop_zone24"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone26"] <- "mat_car_swing_prop_zone26"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone27"] <- "mat_car_swing_prop_zone27"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone28"] <- "mat_car_swing_prop_zone28"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone29"] <- "mat_car_swing_prop_zone29"
colnames(b)[colnames(b)=="car_bat_swing_prop_zone30"] <- "mat_car_swing_prop_zone30"
c <- (statcast_2017_2018[134:159])*(statcast_2017_2018[498:523])
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone1"] <- "mat_car_whiff_prop_zone1"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone2"] <- "mat_car_whiff_prop_zone2"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone3"] <- "mat_car_whiff_prop_zone3"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone4"] <- "mat_car_whiff_prop_zone4"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone5"] <- "mat_car_whiff_prop_zone5"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone6"] <- "mat_car_whiff_prop_zone6"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone7"] <- "mat_car_whiff_prop_zone7"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone8"] <- "mat_car_whiff_prop_zone8"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone9"] <- "mat_car_whiff_prop_zone9"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone11"] <- "mat_car_whiff_prop_zone11"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone12"] <- "mat_car_whiff_prop_zone12"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone13"] <- "mat_car_whiff_prop_zone13"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone14"] <- "mat_car_whiff_prop_zone14"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone16"] <- "mat_car_whiff_prop_zone16"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone17"] <- "mat_car_whiff_prop_zone17"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone18"] <- "mat_car_whiff_prop_zone18"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone19"] <- "mat_car_whiff_prop_zone19"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone21"] <- "mat_car_whiff_prop_zone21"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone22"] <- "mat_car_whiff_prop_zone22"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone23"] <- "mat_car_whiff_prop_zone23"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone24"] <- "mat_car_whiff_prop_zone24"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone26"] <- "mat_car_whiff_prop_zone26"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone27"] <- "mat_car_whiff_prop_zone27"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone28"] <- "mat_car_whiff_prop_zone28"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone29"] <- "mat_car_whiff_prop_zone29"
colnames(c)[colnames(c)=="car_bat_whiff_prop_zone30"] <- "mat_car_whiff_prop_zone30"
d <- (statcast_2017_2018[160:185])*(statcast_2017_2018[550:575])
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone1"] <- "mat_car_k_bb_prop_zone1"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone2"] <- "mat_car_k_bb_prop_zone2"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone3"] <- "mat_car_k_bb_prop_zone3"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone4"] <- "mat_car_k_bb_prop_zone4"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone5"] <- "mat_car_k_bb_prop_zone5"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone6"] <- "mat_car_k_bb_prop_zone6"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone7"] <- "mat_car_k_bb_prop_zone7"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone8"] <- "mat_car_k_bb_prop_zone8"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone9"] <- "mat_car_k_bb_prop_zone9"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone11"] <- "mat_car_k_bb_prop_zone11"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone12"] <- "mat_car_k_bb_prop_zone12"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone13"] <- "mat_car_k_bb_prop_zone13"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone14"] <- "mat_car_k_bb_prop_zone14"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone16"] <- "mat_car_k_bb_prop_zone16"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone17"] <- "mat_car_k_bb_prop_zone17"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone18"] <- "mat_car_k_bb_prop_zone18"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone19"] <- "mat_car_k_bb_prop_zone19"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone21"] <- "mat_car_k_bb_prop_zone21"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone22"] <- "mat_car_k_bb_prop_zone22"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone23"] <- "mat_car_k_bb_prop_zone23"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone24"] <- "mat_car_k_bb_prop_zone24"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone26"] <- "mat_car_k_bb_prop_zone26"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone27"] <- "mat_car_k_bb_prop_zone27"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone28"] <- "mat_car_k_bb_prop_zone28"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone29"] <- "mat_car_k_bb_prop_zone29"
colnames(d)[colnames(d)=="car_bat_k_bb_prop_zone30"] <- "mat_car_k_bb_prop_zone30"
e <- (statcast_2017_2018[220:245])*(statcast_2017_2018[420:445])
colnames(e)[colnames(e)=="car_bat_ba_prop_zone1"] <- "mat_car_ba_prop_zone1"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone2"] <- "mat_car_ba_prop_zone2"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone3"] <- "mat_car_ba_prop_zone3"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone4"] <- "mat_car_ba_prop_zone4"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone5"] <- "mat_car_ba_prop_zone5"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone6"] <- "mat_car_ba_prop_zone6"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone7"] <- "mat_car_ba_prop_zone7"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone8"] <- "mat_car_ba_prop_zone8"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone9"] <- "mat_car_ba_prop_zone9"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone11"] <- "mat_car_ba_prop_zone11"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone12"] <- "mat_car_ba_prop_zone12"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone13"] <- "mat_car_ba_prop_zone13"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone14"] <- "mat_car_ba_prop_zone14"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone16"] <- "mat_car_ba_prop_zone16"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone17"] <- "mat_car_ba_prop_zone17"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone18"] <- "mat_car_ba_prop_zone18"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone19"] <- "mat_car_ba_prop_zone19"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone21"] <- "mat_car_ba_prop_zone21"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone22"] <- "mat_car_ba_prop_zone22"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone23"] <- "mat_car_ba_prop_zone23"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone24"] <- "mat_car_ba_prop_zone24"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone26"] <- "mat_car_ba_prop_zone26"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone27"] <- "mat_car_ba_prop_zone27"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone28"] <- "mat_car_ba_prop_zone28"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone29"] <- "mat_car_ba_prop_zone29"
colnames(e)[colnames(e)=="car_bat_ba_prop_zone30"] <- "mat_car_ba_prop_zone30"
f <- (statcast_2017_2018[250:275])*(statcast_2017_2018[609:634])
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone1"] <- "mat_bi_pitch_prop_zone1"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone2"] <- "mat_bi_pitch_prop_zone2"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone3"] <- "mat_bi_pitch_prop_zone3"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone4"] <- "mat_bi_pitch_prop_zone4"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone5"] <- "mat_bi_pitch_prop_zone5"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone6"] <- "mat_bi_pitch_prop_zone6"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone7"] <- "mat_bi_pitch_prop_zone7"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone8"] <- "mat_bi_pitch_prop_zone8"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone9"] <- "mat_bi_pitch_prop_zone9"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone11"] <- "mat_bi_pitch_prop_zone11"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone12"] <- "mat_bi_pitch_prop_zone12"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone13"] <- "mat_bi_pitch_prop_zone13"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone14"] <- "mat_bi_pitch_prop_zone14"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone16"] <- "mat_bi_pitch_prop_zone16"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone17"] <- "mat_bi_pitch_prop_zone17"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone18"] <- "mat_bi_pitch_prop_zone18"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone19"] <- "mat_bi_pitch_prop_zone19"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone21"] <- "mat_bi_pitch_prop_zone21"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone22"] <- "mat_bi_pitch_prop_zone22"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone23"] <- "mat_bi_pitch_prop_zone23"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone24"] <- "mat_bi_pitch_prop_zone24"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone26"] <- "mat_bi_pitch_prop_zone26"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone27"] <- "mat_bi_pitch_prop_zone27"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone28"] <- "mat_bi_pitch_prop_zone28"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone29"] <- "mat_bi_pitch_prop_zone29"
colnames(f)[colnames(f)=="bi_bat_pitch_prop_zone30"] <- "mat_bi_pitch_prop_zone30"
g <- (statcast_2017_2018[276:301])*(statcast_2017_2018[635:660])
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone1"] <- "mat_bi_swing_prop_zone1"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone2"] <- "mat_bi_swing_prop_zone2"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone3"] <- "mat_bi_swing_prop_zone3"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone4"] <- "mat_bi_swing_prop_zone4"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone5"] <- "mat_bi_swing_prop_zone5"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone6"] <- "mat_bi_swing_prop_zone6"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone7"] <- "mat_bi_swing_prop_zone7"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone8"] <- "mat_bi_swing_prop_zone8"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone9"] <- "mat_bi_swing_prop_zone9"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone11"] <- "mat_bi_swing_prop_zone11"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone12"] <- "mat_bi_swing_prop_zone12"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone13"] <- "mat_bi_swing_prop_zone13"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone14"] <- "mat_bi_swing_prop_zone14"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone16"] <- "mat_bi_swing_prop_zone16"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone17"] <- "mat_bi_swing_prop_zone17"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone18"] <- "mat_bi_swing_prop_zone18"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone19"] <- "mat_bi_swing_prop_zone19"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone21"] <- "mat_bi_swing_prop_zone21"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone22"] <- "mat_bi_swing_prop_zone22"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone23"] <- "mat_bi_swing_prop_zone23"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone24"] <- "mat_bi_swing_prop_zone24"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone26"] <- "mat_bi_swing_prop_zone26"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone27"] <- "mat_bi_swing_prop_zone27"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone28"] <- "mat_bi_swing_prop_zone28"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone29"] <- "mat_bi_swing_prop_zone29"
colnames(g)[colnames(g)=="bi_bat_swing_prop_zone30"] <- "mat_bi_swing_prop_zone30"
h <- (statcast_2017_2018[302:327])*(statcast_2017_2018[661:686])
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone1"] <- "mat_bi_whiff_prop_zone1"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone2"] <- "mat_bi_whiff_prop_zone2"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone3"] <- "mat_bi_whiff_prop_zone3"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone4"] <- "mat_bi_whiff_prop_zone4"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone5"] <- "mat_bi_whiff_prop_zone5"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone6"] <- "mat_bi_whiff_prop_zone6"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone7"] <- "mat_bi_whiff_prop_zone7"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone8"] <- "mat_bi_whiff_prop_zone8"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone9"] <- "mat_bi_whiff_prop_zone9"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone11"] <- "mat_bi_whiff_prop_zone11"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone12"] <- "mat_bi_whiff_prop_zone12"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone13"] <- "mat_bi_whiff_prop_zone13"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone14"] <- "mat_bi_whiff_prop_zone14"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone16"] <- "mat_bi_whiff_prop_zone16"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone17"] <- "mat_bi_whiff_prop_zone17"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone18"] <- "mat_bi_whiff_prop_zone18"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone19"] <- "mat_bi_whiff_prop_zone19"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone21"] <- "mat_bi_whiff_prop_zone21"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone22"] <- "mat_bi_whiff_prop_zone22"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone23"] <- "mat_bi_whiff_prop_zone23"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone24"] <- "mat_bi_whiff_prop_zone24"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone26"] <- "mat_bi_whiff_prop_zone26"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone27"] <- "mat_bi_whiff_prop_zone27"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone28"] <- "mat_bi_whiff_prop_zone28"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone29"] <- "mat_bi_whiff_prop_zone29"
colnames(h)[colnames(h)=="bi_bat_whiff_prop_zone30"] <- "mat_bi_whiff_prop_zone30"
i <- (statcast_2017_2018[328:353])*(statcast_2017_2018[713:738])
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone1"] <- "mat_bi_k_bb_prop_zone1"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone2"] <- "mat_bi_k_bb_prop_zone2"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone3"] <- "mat_bi_k_bb_prop_zone3"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone4"] <- "mat_bi_k_bb_prop_zone4"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone5"] <- "mat_bi_k_bb_prop_zone5"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone6"] <- "mat_bi_k_bb_prop_zone6"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone7"] <- "mat_bi_k_bb_prop_zone7"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone8"] <- "mat_bi_k_bb_prop_zone8"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone9"] <- "mat_bi_k_bb_prop_zone9"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone11"] <- "mat_bi_k_bb_prop_zone11"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone12"] <- "mat_bi_k_bb_prop_zone12"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone13"] <- "mat_bi_k_bb_prop_zone13"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone14"] <- "mat_bi_k_bb_prop_zone14"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone16"] <- "mat_bi_k_bb_prop_zone16"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone17"] <- "mat_bi_k_bb_prop_zone17"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone18"] <- "mat_bi_k_bb_prop_zone18"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone19"] <- "mat_bi_k_bb_prop_zone19"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone21"] <- "mat_bi_k_bb_prop_zone21"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone22"] <- "mat_bi_k_bb_prop_zone22"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone23"] <- "mat_bi_k_bb_prop_zone23"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone24"] <- "mat_bi_k_bb_prop_zone24"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone26"] <- "mat_bi_k_bb_prop_zone26"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone27"] <- "mat_bi_k_bb_prop_zone27"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone28"] <- "mat_bi_k_bb_prop_zone28"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone29"] <- "mat_bi_k_bb_prop_zone29"
colnames(i)[colnames(i)=="bi_bat_k_bb_prop_zone30"] <- "mat_bi_k_bb_prop_zone30"
j <- (statcast_2017_2018[387:412])*(statcast_2017_2018[583:608])
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone1"] <- "mat_bi_ba_prop_zone1"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone2"] <- "mat_bi_ba_prop_zone2"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone3"] <- "mat_bi_ba_prop_zone3"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone4"] <- "mat_bi_ba_prop_zone4"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone5"] <- "mat_bi_ba_prop_zone5"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone6"] <- "mat_bi_ba_prop_zone6"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone7"] <- "mat_bi_ba_prop_zone7"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone8"] <- "mat_bi_ba_prop_zone8"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone9"] <- "mat_bi_ba_prop_zone9"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone11"] <- "mat_bi_ba_prop_zone11"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone12"] <- "mat_bi_ba_prop_zone12"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone13"] <- "mat_bi_ba_prop_zone13"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone14"] <- "mat_bi_ba_prop_zone14"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone16"] <- "mat_bi_ba_prop_zone16"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone17"] <- "mat_bi_ba_prop_zone17"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone18"] <- "mat_bi_ba_prop_zone18"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone19"] <- "mat_bi_ba_prop_zone19"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone21"] <- "mat_bi_ba_prop_zone21"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone22"] <- "mat_bi_ba_prop_zone22"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone23"] <- "mat_bi_ba_prop_zone23"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone24"] <- "mat_bi_ba_prop_zone24"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone26"] <- "mat_bi_ba_prop_zone26"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone27"] <- "mat_bi_ba_prop_zone27"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone28"] <- "mat_bi_ba_prop_zone28"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone29"] <- "mat_bi_ba_prop_zone29"
colnames(j)[colnames(j)=="bi_bat_ba_prop_zone30"] <- "mat_bi_ba_prop_zone30"
```

```{r}
matchups <- bind_cols(a,b,c,d,e,f,g,h,i,j)
statcast_2017_2018 <- bind_cols(statcast_2017_2018, matchups)
```

```{r}
a <- distinct(statcast_2017_2018[1:200000,])
b <- distinct(statcast_2017_2018[200001:400000,])
c <- distinct(statcast_2017_2018[400001:600000,])
d <- distinct(statcast_2017_2018[600001:800000,])
e <- distinct(statcast_2017_2018[800001:900000,])
i <- distinct(statcast_2017_2018[900001:1000000,])
f <- distinct(statcast_2017_2018[1000001:1100000,])
j <- distinct(statcast_2017_2018[1000001:1200000,])
g <- distinct(statcast_2017_2018[1200001:1150000,])
m <- distinct(statcast_2017_2018[1150001:1250000,])
l <- distinct(statcast_2017_2018[1250001:1300000,])
k <- distinct(statcast_2017_2018[1300001:1400000,])
h <- distinct(statcast_2017_2018[1400001:1520525,])
```

```{r}
h <- distinct(statcast_2017_2018[1400001:1520525,])
```


```{r}
statcast_2017_2018 <- rbind(a,b,c,d,e,f,g,i,j,k,l)
colnames(statcast_2017_2018)[colnames(statcast_2017_2018)=="car_pit_h"] <- "car_pit_h9"
colnames(statcast_2017_2018)[colnames(statcast_2017_2018)=="biseason_pit_h"] <- "car_pit_h9"
write.csv(statcast_2017_2018, "Statcast_2017_2018.csv")
data <- read_csv("Statcast_2017_2018.csv")
```

```{r}
statcast1 <- statcast_2017_2018[1:410000,]
statcast2 <- statcast_2017_2018[410001:820000,]
statcast3 <- statcast_2017_2018[810001:1220000,]
statcast_2017_2018 <- statcast_2017_2018[-c(1:410000),]
write.csv(statcast1, "Statcast_1.csv")
write.csv(statcast2, "Statcast_2.csv")
write.csv(statcast3, "Statcast_3.csv")
write.csv(statcast_2017_2018, "Statcast_4.csv")
statcast1a <- statcast1[1:310000,]
statcast1b <- statcast1[310001:410000,]
statcast3a <- statcast3[1:310000,]
statcast3b <- statcast3[310001:410000,]
statcast_4 <- rbind(statcast1b, statcast3b, statcast_2017_2018)
write.csv(statcast_4, "Statcast_4.csv")
write.csv(statcast1a, "Statcast_1.csv")
write.csv(statcast3a, "Statcast_3.csv")
statcast_4a <- statcast_4[1:450000,]
statcast_4b <- statcast_4[450001:490525,]
write.csv(statcast_4a, "Statcast_4.csv")
statcast_3 <- rbind(statcast_4b, statcast3a)
write.csv(statcast_3, "Statcast_3.csv")
write.csv(statcast_4a[1:400000,], "Statcast_4a.csv")
write.csv(statcast_4a[400001:450000,], "Statcast_4b.csv")
```


